<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="18082" />

<meta name="date" content="2019-01-18" />

<title>Introduction to StatComp18082</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18082</h1>
<h4 class="author"><em>18082</em></h4>
<h4 class="date"><em>2019-01-18</em></h4>



<div id="function-1" class="section level1">
<h1>Function 1</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MCestimate=<span class="cf">function</span>(n,x){
  u=<span class="kw">runif</span>(n)  <span class="co">#Generate iid Uniform(0,1) random numbers</span>
  cdf=<span class="kw">numeric</span>(<span class="kw">length</span>(x))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){
    g=<span class="dv">30</span><span class="op">*</span>x[i]<span class="op">^</span><span class="dv">3</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>x[i])<span class="op">^</span><span class="dv">2</span>
    cdf[i]=<span class="kw">mean</span>(g)  <span class="co">#the estimated value of the cdf</span>
  }
  phi=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)  <span class="co">#the estimated values returned by the pbeta function</span>
  <span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,cdf,phi),<span class="dv">3</span>)) <span class="co">#Compare the estimates with the value F(x) computed (numerically) by the pbeta function.</span>
}
<span class="kw">MCestimate</span>(<span class="dv">1000</span>,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)<span class="op">/</span><span class="dv">10</span>)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
## x   0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900
## cdf 0.009 0.058 0.164 0.319 0.502 0.686 0.841 0.947 0.996
## phi 0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991</code></pre>
</div>
<div id="function-2" class="section level1">
<h1>Function 2</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq_test=<span class="cf">function</span>(x, y) {
  n=<span class="kw">sum</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y)
  ni._x=<span class="kw">sum</span>(x)
  ni._y=<span class="kw">sum</span>(y)
  chisq.statistic=<span class="dv">0</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    n.j=x[i] <span class="op">+</span><span class="st"> </span>y[i]
    expected_x=(ni._x<span class="op">*</span>n.j)<span class="op">/</span>n
    expected_y=(ni._y<span class="op">*</span>n.j)<span class="op">/</span>n
    chisq.statistic=chisq.statistic<span class="op">+</span>((x[i]<span class="op">-</span>expected_x)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>expected_x
    chisq.statistic=chisq.statistic<span class="op">+</span>((y[i]<span class="op">-</span>expected_y)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>expected_y
  }
  chisq.statistic
}
<span class="kw">chisq_test</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">9</span>),<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">5</span>))</code></pre></div>
<pre><code>## [1] 2.324313</code></pre>
</div>
<div id="function-3" class="section level1">
<h1>Function 3</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Jacknife.estimate=<span class="cf">function</span>(x,y){
  <span class="kw">set.seed</span>(<span class="dv">1</span>)
  n=<span class="kw">length</span>(x)
  theta.hat=<span class="kw">cor</span>(x,y) <span class="co">#the correlation estimate</span>
  <span class="kw">print</span>(theta.hat)

  <span class="co">#compute the jackknife replicates, leave-one-out estimates</span>
  theta.jack=<span class="kw">numeric</span>(n)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    theta.jack[i]=<span class="kw">cor</span>(x[<span class="op">-</span>i],y[<span class="op">-</span>i])
  }
  bias=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
  <span class="kw">print</span>(bias)  <span class="co">#a jackknife estimate of the bias of the correlation statistic</span>
  se=<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">print</span>(se)  <span class="co">#a jackknife estimate of the standard error of the correlation statistic</span>
}
<span class="kw">Jacknife.estimate</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.8</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="fl">1.3</span>),<span class="kw">c</span>(<span class="dv">4</span>,<span class="fl">2.7</span>,<span class="fl">5.4</span>,<span class="fl">3.6</span>,<span class="fl">6.3</span>,<span class="fl">3.9</span>,<span class="fl">4.7</span>,<span class="fl">3.9</span>,<span class="fl">2.8</span>,<span class="fl">5.6</span>))</code></pre></div>
<pre><code>## [1] 0.07134592
## [1] 0.04075846
## [1] 0.4554599</code></pre>
</div>
<div id="homework-1-2018914" class="section level1">
<h1>Homework 1 (2018/9/14)</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>creat a frame</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ID=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
age=<span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">34</span>,<span class="dv">28</span>,<span class="dv">52</span>)
status=<span class="kw">c</span>(<span class="st">&quot;poor&quot;</span>,<span class="st">&quot;improved&quot;</span>,<span class="st">&quot;excelled&quot;</span>,<span class="st">&quot;poor&quot;</span>)
patientdata&lt;-<span class="kw">data.frame</span>(ID,age,status)
patientdata</code></pre></div>
<pre><code>##   ID age   status
## 1  1  25     poor
## 2  2  34 improved
## 3  3  28 excelled
## 4  4  52     poor</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Perform calculations on the matrix</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1=<span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nr=</span><span class="dv">2</span>,<span class="dt">nc=</span><span class="dv">2</span>)
m2=<span class="kw">matrix</span>(<span class="dv">2</span>,<span class="dt">nr=</span><span class="dv">2</span>,<span class="dt">nc=</span><span class="dv">2</span>)
m=<span class="kw">rbind</span>(m1,m2)  <span class="co">#merge matrices</span>
m</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1
## [3,]    2    2
## [4,]    2    2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="kw">cbind</span>(m1,m2)
n</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    1    2    2
## [2,]    1    1    2    2</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>The 2D graphics of 10 pairs of random values</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rnorm</span>(<span class="dv">10</span>)
y=<span class="kw">rnorm</span>(<span class="dv">10</span>)
<span class="kw">plot</span>(x,y,<span class="dt">xlab=</span><span class="st">&quot;Ten random values&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Ten other values&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">main=</span><span class="st">&quot;How to customize a plot with R&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-2-2018921" class="section level1">
<h1>Homework 2 (2018/9/21)</h1>
</div>
<div id="question-1-1" class="section level1">
<h1>Question 1</h1>
<div id="exercise-3.5" class="section level4">
<h4>Exercise 3.5</h4>
<p>A discrete random variable X has probability mass function | x | 0 | 1 | 2 | 3 | 4 | |——|—–|—–|—–|—–|—–| | p(x) | 0.1 | 0.2 | 0.2 | 0.2 | 0.3 | Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
</div>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<p>Idea: Use the inverse transformation method and sample function to generate random Numbers, and then compare with the theoretical probability.And in this question,I use two methods to solve the problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Solution 1</span>
x=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
p=<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>) <span class="co">#the theoretical probabilities</span>
cp=<span class="kw">cumsum</span>(p)
n=<span class="dv">1000</span>
r=<span class="kw">numeric</span>(n)
r=x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(n),cp)<span class="op">+</span><span class="dv">1</span>] <span class="co"># the 1000 random numbers generated from the distribution of X</span>
ct=<span class="kw">as.vector</span>(<span class="kw">table</span>(r))  <span class="co"># take the numbers of every value of X in R and form a vector</span>
pr=ct<span class="op">/</span><span class="kw">sum</span>(ct)  <span class="co">#the empirical probabilities</span>
s=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)) <span class="co"># the 1000 random numbers generated from the sample function</span>
st=<span class="kw">as.vector</span>(<span class="kw">table</span>(s))  <span class="co"># take the numbers of every value of X in R and form a vector</span>
psample=st<span class="op">/</span><span class="kw">sum</span>(st)  <span class="co">#the empirical probabilities</span>
comparison=<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),p,pr,psample) 
<span class="co">#the comparison of the empirical,the theoretical and the sample probabilities</span>
comparison</code></pre></div>
<pre><code>##   x   p    pr psample
## 1 0 0.1 0.097   0.100
## 2 1 0.2 0.197   0.198
## 3 2 0.2 0.223   0.203
## 4 3 0.2 0.179   0.176
## 5 4 0.3 0.304   0.323</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">c</span>(ct,st)
rnames=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
cnames=<span class="kw">c</span>(<span class="st">&quot;ct&quot;</span>,<span class="st">&quot;st&quot;</span>)
mymatrix=<span class="kw">matrix</span>(a,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(rnames,cnames)) <span class="co">#Generate a matrix whose elements are the frequencies of each random number generated by inverse transformation and sample function</span>
mymatrix</code></pre></div>
<pre><code>##    ct  st
## 0  97 100
## 1 197 198
## 2 223 203
## 3 179 176
## 4 304 323</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(mymatrix,<span class="dt">xlab=</span><span class="st">&quot;random numbers&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frequency&quot;</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;pink&quot;</span>),<span class="dt">legend=</span><span class="kw">rownames</span>(mymatrix),<span class="dt">beside=</span><span class="ot">TRUE</span>) <span class="co">#the barplot of the frequencies of each random number generated by inverse transformation and sample function</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Solution 2</span>
p=<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>) <span class="co">#the theoretical probabilities</span>
x=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>) <span class="co"># replicates the values of 1</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){
  u=<span class="kw">runif</span>(<span class="dv">1</span>)
  <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.1</span>) x[i]=<span class="dv">0</span>
  <span class="cf">else</span>{
    <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.3</span>) x[i]=<span class="dv">1</span>
    <span class="cf">else</span>{
      <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.5</span>) x[i]=<span class="dv">2</span>
      <span class="cf">else</span>{
        <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.7</span>) x[i]=<span class="dv">3</span>
        <span class="cf">else</span> x[i]=<span class="dv">4</span>
      }
    }
  }
}
<span class="co"># x :the 1000 random numbers generated from the distribution of X</span>
ct=<span class="kw">as.vector</span>(<span class="kw">table</span>(x)) <span class="co"># take the numbers of every value of X in R and form a vector</span>
pr=ct<span class="op">/</span><span class="kw">sum</span>(ct) <span class="co">#the empirical probabilities</span>
s=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)) <span class="co"># the 1000 random numbers generated from the sample function</span>
st=<span class="kw">as.vector</span>(<span class="kw">table</span>(s))  <span class="co"># take the numbers of every value of X in R and form a vector</span>
psample=st<span class="op">/</span><span class="kw">sum</span>(st)  <span class="co">#the empirical probabilities</span>
comparison=<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),p,pr,psample) 
<span class="co">#the comparison of the empirical,the theoretical and the sample probabilities</span>
comparison</code></pre></div>
<pre><code>##   x   p    pr psample
## 1 0 0.1 0.098   0.108
## 2 1 0.2 0.216   0.209
## 3 2 0.2 0.206   0.190
## 4 3 0.2 0.186   0.181
## 5 4 0.3 0.294   0.312</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">c</span>(ct,st)
rnames=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
cnames=<span class="kw">c</span>(<span class="st">&quot;ct&quot;</span>,<span class="st">&quot;st&quot;</span>)
mymatrix=<span class="kw">matrix</span>(a,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(rnames,cnames)) <span class="co">#Generate a matrix whose elements are the frequencies of each random number generated by inverse transformation and sample function</span>
mymatrix</code></pre></div>
<pre><code>##    ct  st
## 0  98 108
## 1 216 209
## 2 206 190
## 3 186 181
## 4 294 312</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(mymatrix,<span class="dt">xlab=</span><span class="st">&quot;random numbers&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frequency&quot;</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;pink&quot;</span>),<span class="dt">legend=</span><span class="kw">rownames</span>(mymatrix),<span class="dt">beside=</span><span class="ot">TRUE</span>) <span class="co">#the barplot of the frequencies of each random number generated by inverse transformation and sample function</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAAP8AOpAAZrYA/wA6AAA6ADo6AGY6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC225C2///bkDrb////AAD/tmb/wMv/25D//wD//7b//9v///8tHSPkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ4klEQVR4nO2d0XqjNhSEJ9uk2ca7Tbp2y5ZNHb//UxZJYAtsQMCBGRP+i3yOg46GiRBCHAFOG52ALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW8ACoM7AwnMoEgO/YjCw8ByKxNgM6kHAoLEH+DIIGDRXOBs2g3pYkUGYdEZujboig35N2Ze0qAODGmkwCnf3Bn28hab/5R+TcNfFEw1qHorpzGtQhpfwIa8+TAp3o3iqQRMqGFh2yOYfb2dbssefk8PdKn7fBh13r9XHvOUgG1j7VfH7NmhrQX1kKJvQ1ge1cNyFc0FL+9kMmjvcZlBfcWGDiqPnqWfb4871PLnCQHFCBQPLRptnxZ639L0Bb5A/f0Un/NZwY9A26NTnkTOotObznuazjgPIGfT+7A1qDBStJijUDXLdy2sxHmxpHp+8BbkxTtjttuuIMAp6OlXddWe4UYwzaMAc26Sz2MO+f/PCo2Kz1oE0yaB/LzSLFAdFvF+fcxzUYVDu/p2RQ5MMOhQHWHvbGBxuVHFjg8Ll9eEywJti0MF3QMdd13Ax8724+6A03dFuUDjnRmIn9UFh7NfWQzuyorEGB+/FoK/u6MpNDKome9p2/byJHwXciUGh+4k6oSmHWJjseX/uGkmHRlYcjJ/RoMIb1M+JTc4zioenOzHI8hBLobKlGA3diUGGnXQS1Zzrx9sQg9LvJ1uPpE1P8703BYeFi7/8L+bmJtWWowzqwHKgeJjkzFW4+EueQW7kZnSp0Xr9OS5c7UuiQdcVDCx73rx1knBcuNqXdYM6eiRlgz7e+qakB4WrfVk36LeYegFlg4rr1PFNqPsUtQ6DqnuC85/F7tQgG26G2wzqCTe3QctMufqD7PHnYYYJs9kN6hxEvP8R9RmTOumHffb4c+Jw6GbtnQY1M+SsDTruvtgY5C5bso6ZnoHhal92GfR7jL1Bef2sM3Gg6AzqmlEcEK72Jc+gHC+5cQs6tOb+DApX+5LYghpzyNP7oGzCcPG0boPCUDHl7mFauOjLlRhkwc1wm0E94dZhEOtazMKgzpG0cQuadpbnGNSN9SF2mDQtdLP2dRl0hwPFIfqmGzTqUmPChNm9GdSd3TE4XPhyFQb1rjIYFq725SoMsuFmuM2gnnDrMOg8UJw0VrxZ+zoMKm/7dF/Nj1vUSxxJe8HRHOmk+aDgTFuKuP/buEW9sxsUx6v95ePtYV+oNsnuOH4LEx0dA8WxSzJ5BlnmB1UtqGNGceyiXp5BpVibFLwQJuuYMbu/FhQ4GGWY+fNY5zhx5KJeskGxWM1FvVyD8ngl5eccKHYaVG/sd3jreWaDsnpnMPetZ+pAsT0vrX2g2Bz3znzrmTtQRFs2dDtX6wbmvfVMPs2PMCgLrcpkHJRw67l9oLjIjOIIg66lzHrrObkFNXJaVmJQwq3n1IFivHjC7c5KDEogcaC4SoOi42cCIdwqDbLMtF+lQVNvOsfhVmmQZfLCwgZ1JS/YrfZJIGFeP4Rb2qA4Ql2Puy4we7BAP60LDRvhZAzyV5bxMp2xBqX20L1LgkI4GYOuRE8yKOVE37ckKITTMigzOMSSDUoLp2RQbnJfbMUGnWoPjNoMqv8lYHDbZ90Glc9d85t+ToNaB4rBGoNHU9ikdpxIBnXgpv/ifzzrtk/jH6hj0OkAxCMTkftiQgY19W0G9ejbDOrRtxnUo28zqEffZlCPvs2gHn2f0qCuKddTPanwkxrUWsSRYzOoyyCf9RRvOnCPB26eFk7JoOzxr82gDoPev+63PqjDIHclv6RBiSl4OgY1M55mNig1BU/GIP8s1+UMSk+gUjGoTMHD5CnXNJJT8JoZZqM53a6k+Yeus1ijBd0cSnYxZPOEFrQQqP82YCQ9saoe+lPwFgJDNl7QIKOl0dPBcgVHV0UFyxUcXRUVLFdwdFVUsFzB0VVRwXIFR1dFBcsVHF0VFSxXcHRVVLBcwdFVUcFyBUdXRQXLFRxdFRUsV3B0VVSwXMHRVVExmkBJqspc/MoAW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AGx7txiIfrcQWEbbgg2K/XnDgrbcEPYDGrF5RQ8uRcDG96A9O8ZfjUOeuIYFF46/mL6z/Yrw3K8rqEFVY9JM92XKt1kDQZVKyRN96V6jdgqDPoa1tja7ovPDnxdh0FztCDP4WG/BoNm6YOqiGswyJ/FPt6ebN4uXeLXxueuBRmndsE2XBp+HOQW3BoOWXKEJwWZBj1tF6u9gC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AEfe+dq3LqLH1c8EZo6fxGZQD5tBJ/c++x/u4XnlM+aPuz934dFi7v1WP3xyD/w7VN6f3V9eXD5vlYgWNvWpUcWP2gbvz9+fy1evZKF8qCckBVvohkWQFI47l7dzeKqygIsf7oN71XnuEnty78FTscvuL87LrErLDJteDIo28L/4181m5QdfT5UUbKAbBjGS8Klfx2/7cFj434oP4RA5POzD89GKY83vbfnj9Vyw+HwxKNogvIq3cCpkluXlB5O37QVgFaiPc/JgHh8vYU+8L+7PlWWXH6fzpheDog3KN4s87EM3dvHRzCEYxeklGFR0FF/+fr4YlNUNau7/uWCrQT6luPiZl+viyyzOMinYAFgEScELP+/cTC3oFOfOHkafG2NgECMJL9z7kddOSb5d1fqgVoNerh0s+yD3GvjXqJ7GpynAIEYS5xZ03OHlvNf+5NM4i7UY5F4TVhw5TYPKouE9dFUmeZUUbKAbBjGSOPdBD/vD5Zx9axzUYpB/iOOfV4fY92rA5MZBRQMN9VRJwdOBRZA1A7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUCd/wEH3SQ3dQh5qgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="question-2-1" class="section level1">
<h1>Question 2</h1>
<div id="exercise-3.7" class="section level4">
<h4>Exercise 3.7</h4>
<p>Write a function to generate a random sample of size <span class="math inline">\(n\)</span> from the <span class="math inline">\(Beta(a,b)\)</span> distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> density superimposed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># beta(3,2) with pdf f(x)=12x^2(1-x),0&lt;x&lt;1</span>
<span class="co"># g(x)=x^2,0&lt;x&lt;1 and c=12</span>
n=<span class="dv">1000</span>
k=<span class="dv">0</span> <span class="co">#counter for accepted</span>
j=<span class="dv">0</span> <span class="co">#iterations</span>
y=<span class="kw">numeric</span>(n)
<span class="cf">while</span>(k<span class="op">&lt;</span>n){
  u=<span class="kw">runif</span>(<span class="dv">1</span>)
  j=j<span class="op">+</span><span class="dv">1</span>
  x=<span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#andom variate from g</span>
  <span class="cf">if</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">&gt;</span>u){
    <span class="co">#we accept x</span>
    k=k<span class="op">+</span><span class="dv">1</span>
    y[k]=x <span class="co">#deliver y=x</span>
  }
}
j</code></pre></div>
<pre><code>## [1] 12001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># y:the 1000 random numbers generated from the Beta(a,b) distribution</span>
<span class="kw">plot</span>(y) <span class="co">#the scatter plot of the 1000 random numbers generated from the Beta(a,b) distribution</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">24</span><span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">-</span><span class="dv">12</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#density histogram of sample</span>
t=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)
<span class="kw">lines</span>(t,<span class="dv">12</span><span class="op">*</span>t<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>t)) <span class="co">#density curve f(x)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZrY6kNtmAABmADpmOgBmOjpmOmZmZmZmkLZmtttmtv+QOgCQOjqQZgCQkGaQkLaQtv+Q27aQ2/+2ZgC2kGa2kJC227a22/+2///bkDrbtpDb////tmb/tpD/25D/27b//7b//9v///9P5Q8uAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKQUlEQVR4nO2d62LjthGFsVnb6dXaJk3tNG1XSRvVqiLp/d+uBC8iARI4uAxJUDrnjwSLMwN+wo0QPVRXyiu1dgVKFwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQIwM6vSj1hg56YEDn3dv1+OkrOOqBAR2fPq6Xd9SEHhiQlm5FfokDuvzyz9v7//3wIeTJp5wohydkKw3ot+//Myidvv9VyJNP6VEO30BLKUDnv9Qzwvk7c9A7/c5Vg9++U+rTn2/f39GeT3pPuBu4o/TWVrxaBzhEywHaV+G/VmPeq/V3VxvWU2ylz7/eiiaF3lOFHs7F7p7SWVvxGivcfsQAXd7rYOOv5PRiI2uPV3+rvtV39doVLQo3T/8NWaw4ovTWVrzG6FvcfgQB6e/wvBt9ky05W+fd8+ClwvGTSaHzdPlRff4JA3JE6a2teLX2dZtaZhY76lDP1ctzU3qu479d+5dptRWuBqB6DOoNW0/X85cfPkbDUxcTRhlZ63iGHZYooH3bgoeneFDPPjtt0FT7bWi4H/QFB6DAKIZ1HW9ohyXZxaqO3lTmvPvm37u20R+Ve6lxeqk/21eHHtue0BjePDUepgGFRRlaN/GGdliSgM67rjIH9fvu7VE1dWl6fN3Q+vrWI/Gh6V1vA8Pe09UNaCrKWAPrNt7QDmseQFUL6Di4q35Qn/VSsJmB2vNoDcMABUXprdt4hh3WPICqd12FXVWvatn0ikPXtPTX2xo6AFmtcBxlopl21rd4hh3WLGNQVdG/dnXsRger7pfbksQA1BoGjUFTUcbqm+brhB2W6Dqom3uO9YzWnJZjfrGn2eY8boYhs1hAlN56EG9ohyUKqJ08z3qOaGeoZggeqV35q0EfeRsaHic6iaWAKL31IJ5hhzXHSrr5eg51I3CscY9qClBvOFyTOwAFROmtB/GGdgGS3e4IvhZL8ORTapQAyQK6vNtDAd6RCvXkU2qUAAlvmI32g/6Yupdle/IpPQqW9I7i5cfheYXvCiJPPuVEgZLfk/55sCf9j6w96Z8D96SzoiA9+K8aWAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQNsDNFljNdt5bA6Qq8JzncjWALnrO1Mj2hYgLwQCaiurbJkfzxKzbLmAdB8PDpwhuLxLcSnjZVRl5XgvGrxo1XV09yRnl5MLXrjU1ainrwXpwkMC8nUjZZUIaPyxUXxEQHYvusaUc4OXL2V3omtUOTO4qLd5ZPch/8fCfUzG2UxTbOfdW9wEoLncNT5jAYnWonxAo/MlINtjNCDJahAQji8pcUDWZcZUjKmyXD0KB6QmnBKQ7S56mpe8uC8RENi/CFpJK+fHsZXJM5/Fnb0zlgKo/ysBPSwg1ykGXqw68CZWRkqCgJyjCAHZczsBTTnJBjTqqRmVkZMYIGWVPTEWAnTeRaRlwu5ynQgAml5mplSmlc50lJsjRAqQssq+GIsBugowEgKkrLI3hrs8dSUXXxlTh0FOHwF3iU5KBaTTEL21yZIE3CU78RMJBzQazVIqc3tXjdJtprSjswnppLTK18ZELzUc5ZUAnXc459Mtr9XRNVJJAPLc3zIZYylAXxo+7uYzzBbtSvlUGKDRhJhQm+5NB8iThXqQGtyFUQDQ+EeJEgDt+90p9zS/SAuaOKUSAPUtyKdbtsIZxyBZQBPtMb4+EdIznZZzHZANaGpY3RCg+d1JA8r+pb4xP+9eu8aRs47OBzS59i0AULRcc51Ibe4BkO1F9EcoUUCSlxqv+lI1L+lnXm3UtJNCAO2fPk4vz9d91rZZUm3Qjc5lAKofR6YfqLD8IK0crw6nKwLSz28IeuANdpdgpKyyy2ksIJFuX2n/rLNcGw93sXRbCbgXA/cMqDr9T1/9aZw9ib9H7qLroKyy02l0F8siFGcM02A/OiD3IxzS3A2MlFV2O10LENxOjXMXaaSsssfpWoD2WWRG7iKN5gSURWgwzUs8WCAVkLLKPqerAQp+YFKIu0ijDQCKe04DdBdnpKyy1+lKgOAEFekuxiiOQMKlRgahQRdbbcMs8+JqIUAyKhRQxmkWAAhtbxQDqOpkTx/7vMn+ngEdP3096Kv5pe8Pgr+kSgBKJzSY5l/r30uX3g+amIXLBKQXihrQ0juKmwHUtaB91q59dD2mJuE5ACUTsscg98MCI91FGGwEULNUjHpyntdd+PFbASShSHfT4wMBWUdvA1BzLZb7MMVyAaUS6sz23dO6F1xJu6peIqBjNzifXhaYxeJ+ai4B0GC3bInf5q2xeQOABldgSZcakbe/WJP7MoASCXWA4A2+Me5CjlJm0eckE1De/9GvBUiZRa8T2RZEQM7Dp5elQCsBUmbR76QIQPDGlhh38CjzsA0AElPMNO80IiACAgetBMhefwWJgIBWAJSQ1k7o8GIBgcUsARmrQiV4xrGHK2cVnVoa0NSXSEBgpiUgAgLulPVmNUDX8QCItCgg+9Vh9LCA7IbkMnpUQPZI5DR6UED2XO822jCgxOwv9uSxHqBr9D8mRB2emv3F/t7uFVBy7g6xlFL5h88KKDn7i1xKqezDS21B3vLdAErM/jL3/3nHHZ72w2GoErK/TGxv3DGgeHf2EmjqqMcDtGwqhSIB+bO/3DA5gqwJaN6VtNOL2VZGLagorQHojkVAQHGARP63flsSvli9PwlfarROi9Z8gIJvs0JOwed5H+eaZxwe3oLygm4WUMDFapjTuwWEL1bDnN4vICGnBJT3OQERUN7nBPTwgO5JBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBAkoCOwwRWx+hsVrZFZDY1w1w/7FMiu7EoIJ1B5pZFxijEm+tyXDIjw/ygCzKE5AA1Pwq1yWOMQrz5tc0Lmhz9OTK6W3KAmsxD7Y1DRiHeXL97+nsMIMO8UEDf6vbd/uRqFOLN62LUGGSaF9nFmgGgHQaMQrx53WOiAFkB46cIlwoFFJ0T1DTXT3g4vYjcgVJmF6sL6V0sfgR0q8xB+tDeqRI+ihjm8e3XrWKn+cgWZJg3tPIyIXUqd6EYuZI2zIscg+qOoWvYrEIO0fOIYX6NvtQwzPfK90zmGPFiFYiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIBKB1TfEnUQuaE3TaUD0reJXd5l/qsgSaUD0lmvmhs0V1LpgHQf86e7mlnFA6r62H7NlHvFAzp/+deXFXtY+YAu739Ys4eVDyj7Ce+ZKh/QqnPYJgD9ac0etgFAh3XTxpYO6PSy6hBdPqDVRUBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAT0fzZnlLu0kxQ9AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
<div id="question-3-1" class="section level1">
<h1>Question 3</h1>
<div id="exercise-3.12" class="section level4">
<h4>Exercise 3.12</h4>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r,\beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(Exp(\Lambda)\)</span> distribution. That is,<span class="math inline">\((Y |\Lambda = \lambda)\)</span>~<span class="math inline">\(f_{Y}(y|\lambda) = \lambda*e^{-\lambda*y}\)</span>. Generate 1000 random observations from this mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta= 2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#generate a Poisson-Gamma mixture</span>
n=<span class="dv">1000</span>
r=<span class="dv">4</span>
beta=<span class="dv">2</span>
lambda=<span class="kw">rgamma</span>(n, r, beta) <span class="co">#lambda is random</span>
<span class="co">#now supply the sample of lambda???s as the exponential mean</span>
y=<span class="kw">rexp</span>(n, lambda) <span class="co">#the 1000 random numbers generated from the mixture distribution</span>
<span class="kw">plot</span>(y) <span class="co"># the scatter plot of the 1000 random numbers generated from the mixture distribution</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-3-2018928" class="section level1">
<h1>Homework 3 (2018/9/28)</h1>
</div>
<div id="question-1-exercise-5.4" class="section level1">
<h1>Question 1 (Exercise 5.4)</h1>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1,0.2,...,0.9\)</span>. Compare the estimates with the values returned by the <span class="math inline">\(pbeta\)</span> function in R.</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<p>Idea: First,the <span class="math inline">\(Beta(3, 3)\)</span> pdf is <span class="math display">\[p(x)=30x^2(1-x)^2,0&lt;x&lt;1\]</span>,so the <span class="math inline">\(Beta(3, 3)\)</span> cdf is <span class="math display">\[F(x)=\int_{0}^{x}30t^2(1-t)^2dt\]</span>. Making the substitution<span class="math inline">\(y = t/x\)</span>, we have <span class="math inline">\(dt = xdy\)</span> and <span class="math inline">\(\theta=\int_{0}^{1}30x^2y^2(1-xy)^2xdy\)</span>. Where the random variable Y has the <span class="math inline">\(Uniform(0,1)\)</span> distribution.Thus, <span class="math inline">\(\theta=E_{Y}[30x^3Y^2(1-xY)^2]\)</span>.Generate iid <span class="math inline">\(Uniform(0,1)\)</span> random numbers <span class="math inline">\(u_{1},u_{2},\cdots,u_{m}\)</span> and compute <span class="math display">\[\hat{\theta}=\overline{g_{m}(u)}=1/m\sum_{i=1}^{m}30x^3u_{i}^2(1-xu_{i})^2\]</span>. The sample mean<span class="math inline">\(\hat{\theta}\)</span>converges to <span class="math inline">\(E[\hat{\theta}]=\theta\)</span> as <span class="math inline">\(m\to\infty\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#write a function to compute aMonte Carlo estimate of the Beta(3,3)</span>
my_MCestimate=<span class="cf">function</span>(n,x){
  u=<span class="kw">runif</span>(n)  <span class="co">#Generate iid Uniform(0,1) random numbers</span>
  cdf=<span class="kw">numeric</span>(<span class="kw">length</span>(x)) 
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){
    g=<span class="dv">30</span><span class="op">*</span>x[i]<span class="op">^</span><span class="dv">3</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>x[i])<span class="op">^</span><span class="dv">2</span>
    cdf[i]=<span class="kw">mean</span>(g)  <span class="co">#the estimated value of the cdf</span>
  }
  phi=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)  <span class="co">#the estimated values returned by the pbeta function</span>
  <span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,cdf,phi),<span class="dv">3</span>)) <span class="co">#Compare the estimates with the value F(x) computed (numerically) by the pbeta function.</span>
}
x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)<span class="op">/</span><span class="dv">10</span>
n=<span class="dv">1000</span>
<span class="kw">my_MCestimate</span>(n,x) <span class="co">#the estimated values returned by the my_MCestimate function</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
## x   0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900
## cdf 0.008 0.057 0.161 0.314 0.495 0.678 0.833 0.941 0.993
## phi 0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991</code></pre>
<div id="analysis" class="section level3">
<h3>Analysis:</h3>
<p>From the results, the estimated value by monte carlo method is close to the estimated value from the pbeta function.This shows that we can use monte carlo method to estimate the distribution function directly.</p>
</div>
</div>
<div id="question-2-exercise-5.9" class="section level1">
<h1>Question 2 (Exercise 5.9)</h1>
<p>The Rayleigh density [156, (18.76)] is<span class="math display">\[f(x)=\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2},x\ge0,\sigma&gt;0\]</span> Implement a function to generate samples from a <span class="math inline">\(Rayleigh(\sigma)\)</span> distribution,using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with<span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent <span class="math inline">\(X_{1},X_{2}\)</span>?</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<p>Idea: <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2},x\ge0,\sigma&gt;0\)</span>,so the cdf is <span class="math display">\[F(x)=\int_{0}^{x}\frac{t}{\sigma^2}e^-\frac{t^2}{2\sigma^2},t\geq0,\sigma&gt;0\]</span>.Making the substitution <span class="math inline">\(u = t/x\)</span>, we have <span class="math inline">\(dt = xdu\)</span> and <span class="math display">\[\theta=\int_{0}^{1}\frac{ux^2}{\sigma^2}e^-\frac{(xu)^2}{2\sigma^2}du\]</span>. Where the random variable U has the <span class="math inline">\(Uniform(0,1)\)</span> distribution.Thus, <span class="math display">\[\theta=E_{U}[\frac{Ux^2}{\sigma^2}e^-\frac{(xU)^2}{2\sigma^2}]\]</span>. Generate random numbers <span class="math inline">\(u_{1},\dots,u_{m/2}\sim uniform(0,1)\)</span> and compute half of the replicates using <span class="math display">\[Y_{j}=g^{(j)}(u)=\frac{u_{j}x^2}{\sigma^2}e^-\frac{(xu_{j})^2}{2\sigma^2},j=1,2,\dots,m/2\]</span>; <span class="math display">\[Y'_{j}=\frac{(1-u_{j})x^2}{\sigma^2}e^-\frac{(x(1-u_{j})^2}{2\sigma^2},j=1,2,\dots,m/2\]</span>. Thus,<span class="math display">\[\hat{\theta}=\overline{g_{m}(u)}=\frac{1}{m}\sum_{j=1}^{m/2}(\frac{u_{j}x^2}{\sigma^2}e^-\frac{(xu_{j})^2}{2\sigma^2}+\frac{(1-u_{j})x^2}{\sigma^2}e^-\frac{(x(1-u_{j})^2}{2\sigma^2})\]</span>.The sample mean<span class="math inline">\(\hat{\theta}\)</span>converges to <span class="math inline">\(E[\hat{\theta}]=\theta\)</span> as <span class="math inline">\(m\to\infty\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Implement a function to generate samples from a $Rayleigh(\sigma)$ distribution,using antithetic variables.</span>
MC.av=<span class="cf">function</span>(x, <span class="dt">m=</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {
u=<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>) <span class="co">#Generate random numbers u(1),u(2),...,u(m/2)~Unifrom(0,1)</span>
<span class="cf">if</span> (<span class="op">!</span>antithetic) v=<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span>
v=<span class="dv">1</span><span class="op">-</span>u
u=<span class="kw">c</span>(u, v)
sigma=<span class="dv">10</span>
cdf=<span class="kw">numeric</span>(<span class="kw">length</span>(x))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
g=u<span class="op">*</span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(u <span class="op">*</span><span class="st"> </span>x[i])<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span>)
cdf[i]=<span class="kw">mean</span>(g)  <span class="co">#the estimated value of the cdf</span>
}
cdf
}
x=<span class="kw">seq</span>(<span class="fl">1.0</span>,<span class="fl">5.0</span>,<span class="dt">length=</span><span class="dv">10</span>)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC1=<span class="kw">MC.av</span>(x,<span class="dt">anti=</span><span class="ot">FALSE</span>) ##generate samples from the distribution without using antithetic variables
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC2=<span class="kw">MC.av</span>(x) <span class="co">#generate samples from the distribution by using antithetic variables</span>
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,MC1,MC2),<span class="dv">10</span>))</code></pre></div>
<pre><code>##            [,1]         [,2]         [,3]         [,4]         [,5]
## x   1.00000e+00 1.4444444444 1.8888888889 2.3333333333 2.7777777778
## MC1 9.88451e-05 0.0000982329 0.0000986473 0.0001000469 0.0001016321
## MC2 9.96330e-05 0.0000988275 0.0000985151 0.0000989835 0.0000995878
##             [,6]         [,7]         [,8]         [,9]        [,10]
## x   3.2222222222 3.6666666667 4.1111111111 4.5555555556 5.0000000000
## MC1 0.0001029100 0.0001038075 0.0001044149 0.0001048328 0.0001051275
## MC2 0.0000999399 0.0001000233 0.0000999615 0.0000998881 0.0000999021</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2))</code></pre></div>
<pre><code>## [1] 2.725218e-06 5.477578e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>((<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1)) <span class="co">#the percent reduction in variance  of $\frac{X+X'}{2}$  compared with$\frac{X_{1}+X_{2}}{2}$ for independent $X_{1},X_{2}$</span></code></pre></div>
<pre><code>## [1] 0.9596006</code></pre>
<div id="analysis-1" class="section level3">
<h3>Analysis:</h3>
<p>From the results,we can conclude that the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent <span class="math inline">\(X_{1},X_{2}\)</span> is 95.9%.</p>
</div>
</div>
<div id="question-3-exercise-5.13" class="section level1">
<h1>Question 3 (Exercise 5.13)</h1>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^-x^2/2,x&gt;1\]</span>. Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^\frac{-x^2}{2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<p>Idea: <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^-x^2/2,x&gt;1\)</span>,two possible choices of important function to estimate <span class="math inline">\(\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^-x^2/2dx\)</span> by sampling method are compared.The two important functions are <span class="math display">\[f1=\frac{1}{\sqrt{2\pi}}e^-\frac{x^2}{2}\]</span> and <span class="math display">\[f2=\frac{1}{2}x^2e^-x\]</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m=<span class="dv">10000</span>
theta.hat=se=<span class="kw">numeric</span>(<span class="dv">2</span>)
g=<span class="cf">function</span>(x) {
((x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x<span class="op">&gt;</span><span class="dv">1</span>)
}
x=<span class="kw">rnorm</span>(m) <span class="co">#using f1</span>
fg1=<span class="kw">g</span>(x)<span class="op">/</span>((<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>))
theta.hat[<span class="dv">1</span>]=<span class="kw">mean</span>(fg1) <span class="co">#The first estimate</span>
se[<span class="dv">1</span>]=<span class="kw">sd</span>(fg1) <span class="co">#The variance of the first estimate</span>
x=<span class="kw">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>) <span class="co">#using f2</span>
x=x[x<span class="op">&gt;</span><span class="dv">1</span>] <span class="co">#Limit the range of x,let x&gt;1</span>
fg2=<span class="kw">g</span>(x)<span class="op">/</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x))
theta.hat[<span class="dv">2</span>]=<span class="kw">mean</span>(fg2) <span class="co">#The second estimate</span>
se[<span class="dv">2</span>]=<span class="kw">sd</span>(fg2) <span class="co">#The variance of the second estimate</span>
<span class="kw">rbind</span>(theta.hat, se)</code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3954635 0.4372352
## se        1.1299586 0.4588459</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Draw the curves of g, f1 and f2, then compare them</span>
<span class="kw">curve</span>(g,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">main=</span><span class="st">&quot;The comparsion of the curves of g,f1 and f2&quot;</span>)
f1=<span class="cf">function</span>(x){
  (<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)
}
<span class="kw">curve</span>(f1,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
f2=<span class="cf">function</span>(x){
  (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)
}
<span class="kw">curve</span>(f2,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYA/wA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////AAD/tmb/25D/27b//7b//9v///82pTcQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALPElEQVR4nO2daWPcNBCGnZCwGwilJUuBNuGGbKENxNyJk6z+/59Ch2XL5yt5JUvezvuhdWx5ZvR4dKwt72aMNKosdgCpiwABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQGEA7a6y0zuH4m/OsuxFuf3LLWN5dnQdJDDkvXssCUBFxnUhNx9fHs8NyPDed2y2OEZk8NhmswMac5ZrQH+eZ9kHr+XmX1/wza/49X/aZKu/zrOj1+yPs+xE2ODRv+VHT25kuZcc/LNr5eGHl9nxDfuDWzl6flNnUGVLlPn5TabMlKoObsUlVEHKzePbRmme5tnRCyMhq2AVTR7nRRXES7lLXPnLxplVaGPe1Rkn18puGU61UeZZrjZ5/bhjpXMVdVVMmivqzbw8ozyVlywB1bb0pnGx6oN9gCpTOoyTW31iHWwTkLT2pyTDj9QVOLmtnB3fjnoXcYs/ztuAeGU/u3vciN0PZ+KkXPgX9i8Y95i9VjtEeZ4nfM9KmPrwTpRWsZ3esH9Ext2JoxclIMOW+JcnXl439ubBThMTFrVT7lM5Yq1gW4BEENzzSu+qzzRCG/XOba/udtuaZNnEyqiev9Ob8j9uVV2GU01iqy+POv/vX88FK2HlUjk9ecf0lZDXprJVluFFVg0S+mAX0GVZTVVXvkfH3Am2AnTJdEFp0DjTCM3C+9OmBcgYc/SmOElgVz0RqwDJE6XF3TcqSVfVJVD5Kdu1NGPaKssoY21HQ520LM09NxqnOUC2+qDrMjcuqwTWZxqhjXnXu7ddQPq66hqITm4QkDgoXJ58//fGAMSHaBXPT8qTaasDqOdgP6CyrzMB6WDLwrqdqwLiuNpjnlmHNuZd7+4B5JxBasdTAxBH9N257Pn8ZtAlM9TNoCYg0aS+ldvNM3VoUzKo3FE8+7HdB3UAVX1QofuUZi/HnXzNj/b1QU1AqA+qShunmCVksLkeT80gZMs6vWPdM2VoFt47fZBw8UJccF7n5ijWBaRHMVnu8crsg+TwIpJZJ093qDBiHhhH8nLiUJfeipnY46bKGyNYebYIomFDjM2XakOfaYQ26t0YxVQV8uY8aMVa86AuIGOm0+6k2ZuqyffNg1qAugd1iGqiWJUuZzN1ktbBVt1wo5qFHqWNM+vQRr0b86AmIDU5fSU35RTzFWO9gI5/54OXnJCKUezkx7yRo8JK9qw9k35VZ0Yj69sHVYhiKnvTKP34zVnpk7WDfeB97/O3myag2olxZhXaqHfp/tObbReQnerO67Al5+FsKzETIFNbed9DTWcfzmRHRoBM6amTnAirHocANfT4xVnrU38S94NSFgECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBOQGSN+qP/TbQoacAOX64X8xtODo8OQCaHdVYcldFpAtWi6AnjbVo9zivWlklEFAjn1QmULUBw1Ir8p7b/KH5kFQBAhoAqDCXCVx8HIDtM2yi4dP78wB/9Dl9uhZLBuT2UPDfJ9k3jx8JFeTDUwUs8UoDCAx+9n9y4YzaDF9fhBALNd5o1AZVpwvTGyFAcRyNXwV2VAf/b4DmmguwcxKB1DZ7lJjFBpQPjSKjexIilAqGZSNHYypRAC12lVChNIA1G1wySAKBAg+1UBN6sAB4acasM9JhVAQQBb3pLOB7Z69ayEH734V6LMYfKqBAfHd65rNOhamBDJowHIfjwiQQvVB6KlG1rPV0HroyMyMAo1i8KkGAKQgDPmck1H0eVCfXV3/EZ+zEUoR0LpbqqfQTFkUG1DXrFnxcaezIJoZUOeOYsdss9LA6wyIUsugdo2R2+CE4gK6b5vt1Be6DZ1EaQHqqSz2G5ZQ5CZ23zDbV1ULv0GTKCVA/fW0cRyQUOxO+r7aM5QHVo7DJVFsQJkmNFxDO8+hEKUCaKR6tp7DEIoOqGxkY7WzJhQCUSKAxqtm7TsAoTQAgYrZ+/afRPEBcUKwVg7OfRM6OEC+kygBQDYX3cm7V0SHCMhrO0sA0NqYTvty7y+J4t8wW7MAgPwlUfwMEjVJmFB0QLIeIQB5IhQbUFmLdAkFejYvnqcWFstfdB2CAPLSVYcDlKvvkR1YB9wCFIiQhyQKBqhEM754YV1ZDQRo/yQKBqj8fkqw/MUF0MRucE9EcTPIsBoqhdie7SwQIDEVXLHuuxptc06AphPaA1GoYZ4zOroeeem5AyhkCu2TRJHnQW6AYhBKB1DYFJpMKCFAaRJaGKC9CE1CFHAUG11r3wcocApNQxQmg3ZX6EtfpgLaM5PdCQVqYrur1XiBXkDBU2hCEoXqgwbeVm3fUXQHtHdn6EgopU6azZFCrkm0PEAeInEhlBigWVLIKYlCAwIv9U4B5OVaWSNKLYNmSiFm3c6WCMgXIStEyQGaL4XskijYRNHupd4+q3MSwojCALJ+qTcyIIskCgLI/pXMXqvzEvK1us3t07ztS73xAXlbHzljBs1OaOzlvFB9kOVLvQNWMSHPg+pwGgUaxWxf6h2yGoHQPm9COBV0MjcdkHdCe7xL41bQydyg1flTaCCJZgYEbpjVipFCE1/ocy3oZG7YaowU6hvQkgUUiRBzfO96QkEnc3sBCkbIRJQuoIiEzK91IEAD0oQSBhSb0NrNQwRA8frpKR5iAEqB0NIBBSeUNqAECCUOKH4jSx1QdEJxAdkYjUwofUCRCS0AUFxCSwDE7iGicIQWAShmDsW9o2htNB6hZWRQxFa2FEDRcigQIMvVHS5GLQiFQBQGkO3qDiejcVpZEEDWz+YdaxSDUBBA1qs7XCsEk8h/K1tUBjEbRM4mPdlz7IPsVndMqc3MSRRoFLNc3TGpLvO2s8XMg0zdI0Yeg10kIAYbmr9fKVvORLElnEV+GC1ootjRPYLkg9HShvm2EKS9f5BzWRPFft0rDR7fC9LSM8jQKKfJP/A680Rx6g0zB917k1uIQSaKC1DkB4fpiwABhQZk/UO0qSpaBi1GkQC5GbUsF6XYxOJ+jR4eIPhh1c3owQHCH1bdjB4aIIuPGm5GDw2QxYdVN6OHBogyCAk/1XAzenCA8IdVN6OHB+g9FAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAGFAPTwMfjeciF5e3v0polSnolf8rDRFtxjYOZPp1grAKCnDfpidyb48GrnOFbxhLKwIlSgmzBcDx/ZsTbkH1ABH3oIqR9RGnpAW0n+Rg78onhV0gLQ+J3iXnkHVGQX9mHY5YYVoPz0awwod2pdUiH6IHtAW6uSuQVG3ngs+qDtJ3Ydn6GogMCtbV3IopR4noABPW1Eka0ToZiACsvxZHcFqy6eslhkkHLr1BFFBGSVP6okamNydLIFVP7InqXiAcrtOwNYpbxc02JVc7exPhqg3Ko2Co0dcZxBLta0YgF6OLPLH1Fr44kuKoqKiE5vGZ102SjwAL61bTlWfZC9NS36sApEgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIKHVAYiW1XCwdS6kDEounxr8HI7BSB8SK498+d35/wKOSB8S2bi+f+Fb6gArHNXOelTyg3dWX7m+geFTygPLT/+wWuQZS6oDEt15NeInJn1IHpNZJR+ymUwcUXQQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAvofPglcc7ldeBkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Draw the curves of fg1 and fg2, and compare them</span>
fg1=<span class="cf">function</span>(x){
  <span class="kw">g</span>(x)<span class="op">/</span>((<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>))
}
<span class="kw">curve</span>(fg1,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">main=</span><span class="st">&quot;The comparsion of the curves of fg1 and fg2&quot;</span>)
fg2=<span class="cf">function</span>(x){
  <span class="kw">g</span>(x)<span class="op">/</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x))
}
<span class="kw">curve</span>(fg2,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="analysis-2" class="section level3">
<h3>Analysis:</h3>
<p>From the results,we can conclude that the variance of <span class="math inline">\(f1=\frac{1}{\sqrt{2\pi}}e^-\frac{x^2}{2}\)</span> produced is 1.1691 and the variance of <span class="math inline">\(f2=\frac{1}{2}x^2e^-x\)</span> produced is 0.4635,so the <span class="math inline">\(f2=\frac{1}{2}x^2e^-x\)</span> produce the smaller variance in esmating the integration.From the graphs,we can conclude that the function that corresponds to the most nearly constant ratio <span class="math inline">\(g(x)/f(x)\)</span> appears to be f2.</p>
</div>
</div>
<div id="question-4-exercise-5.14" class="section level1">
<h1>Question 4 (Exercise 5.14)</h1>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^\frac{-x^2}{2}dx\]</span> by importance sampling.</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<p>Idea: From the question 3(exercise 5.13),we know that the <span class="math inline">\(f2=\frac{1}{2}x^2e^-x\)</span> is the more appropriate important function.So,in this question,we can use f2 to estimate tht integration.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m=<span class="dv">10000</span>
theta.hat=se=<span class="kw">numeric</span>(<span class="dv">1</span>)
g=<span class="cf">function</span>(x) {
((x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x<span class="op">&gt;</span><span class="dv">1</span>)
}
x=<span class="kw">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>) <span class="co">#using f</span>
x=x[x<span class="op">&gt;</span><span class="dv">1</span>] <span class="co">#Limit the range of x,let x&gt;1</span>
fg=<span class="kw">g</span>(x)<span class="op">/</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x))
theta.hat[<span class="dv">1</span>]=<span class="kw">mean</span>(fg) <span class="co">#The second estimate</span>
se[<span class="dv">1</span>]=<span class="kw">sd</span>(fg) <span class="co">#The variance of the second estimate</span>
<span class="kw">rbind</span>(theta.hat, se)</code></pre></div>
<pre><code>##                [,1]
## theta.hat 0.4313664
## se        0.4561551</code></pre>
<div id="analysis-3" class="section level3">
<h3>Analysis:</h3>
<p>From the results,we can conclude that the estimate is 0.4313,and I have computed the real value is 0.4006.This result shows that the estimated effect of f2 is good.</p>
</div>
</div>
<div id="homework-4-20181012" class="section level1">
<h1>Homework 4 (2018/10/12)</h1>
</div>
<div id="question-1-exercise-6.9" class="section level1">
<h1>Question 1 (Exercise 6.9)</h1>
<p>Let <span class="math inline">\(X\)</span> be a non-negative random variable with <span class="math inline">\(\mu=E[X]&lt;\infty\)</span>. For a random sample <span class="math inline">\(x_{1},\dots,x_{n}\)</span> from the distribution of <span class="math inline">\(X\)</span>, the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum_{j=1}^{n}\sum_{i=1}^{n}|x_{i}-x_{j}|.\]</span></p>
<p>The Gini ratio is applied in economics to measure inequality in income dis- tribution (see e.g. [163]). Note that <span class="math inline">\(G\)</span> can be written in terms of the order statistics <span class="math inline">\(x_{(i)}\)</span> as <span class="math display">\[\hat{G}=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}.\]</span></p>
<p>If the mean is unknown, let <span class="math inline">\(\hat{G}\)</span> be the statistic G with <span class="math inline">\(\mu\)</span> replaced by <span class="math inline">\(\overline{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal. Repeat the procedure for the uniform distribution and <span class="math inline">\(Bernoulli(0.1)\)</span>. Also construct density histograms of the replicates in each case.</p>
</div>
<div id="anwser" class="section level1">
<h1>Anwser</h1>
<p>Idea:</p>
<p>Generate the replicates <span class="math inline">\(\hat{G}^{(i)},i=1,\dots,n\)</span> when <span class="math inline">\(x\)</span> is standard lognormal,the uniform distribution or <span class="math inline">\(Bernoulli(0.1)\)</span> by repeating:</p>
<p>(1)Generate <span class="math inline">\(x^{(i)}_{1},\dots,x^{(i)}_{n}\)</span> iid from the distribution of x.</p>
<p>(2)sort <span class="math inline">\(x^{(i)}_{1},\dots,x^{(i)}_{n}\)</span> in increaing order,to obtain <span class="math inline">\(x^{(i)}_{(1)}\leq\dots\leq x^{(i)}_{(n)}\)</span>.</p>
<p>(3)compute <span class="math inline">\(\hat{G}^{(i)}=\frac{1}{n^2\mu}\sum_{j=1}^{n}(2j-n-1)x^{(i)}_{(j)}\)</span>.</p>
<p>Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal,the uniform distribution and <span class="math inline">\(Bernoulli(0.1)\)</span>. And construct density histograms of the replicates in each case.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#the number of test n=1000</span>
<span class="co">#estimate the G</span>
n=<span class="dv">1000</span>
G.hat=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span>n)
mean.G.hat=<span class="kw">numeric</span>(<span class="dv">3</span>)
median.G.hat=<span class="kw">numeric</span>(<span class="dv">3</span>)
deciles.G.hat=<span class="kw">numeric</span>(<span class="dv">3</span>)
x=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span>n)
mu.hat=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span>n)
t=<span class="kw">numeric</span>(n)
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){ 
    <span class="co"># i reprent the i-th test</span>
    x[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>n]=<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n)) <span class="co">#generated the random number of x1,...,xn from the standard lognormal distribution,and sort them</span>
    x[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span>n]=<span class="kw">sort</span>(<span class="kw">runif</span>(n)) <span class="co">#generated the random number of x1,...,xn from the uniform distribution,and sort them</span>
    x[<span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span>n]=<span class="kw">sort</span>(<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="co">#generated the random number of x1,...,xn from the Bernoulli(0.1),and sort them</span>
    mu.hat[k,i]=<span class="kw">sum</span>(x[k,<span class="dv">1</span><span class="op">:</span>n])<span class="op">/</span>n  <span class="co">#mu replaced by the mean of x</span>
    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      t[j]=(<span class="dv">2</span><span class="op">*</span>j<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[k,j]
    }
    G.hat[k,i]=<span class="kw">sum</span>(t[<span class="dv">1</span><span class="op">:</span>n])<span class="op">/</span>(mu.hat[k,i]<span class="op">*</span>(n<span class="op">^</span><span class="dv">2</span>)) <span class="co">#the estimate of G from the k-th distribution</span>
  }
}

<span class="co">#Estimate the mean,median and deciles of G.hat if X is standard lognorm,uniform distribution and benoulli(0.1)</span>
mean.G.hat=<span class="kw">apply</span>(G.hat,<span class="dv">1</span>,mean) <span class="co">#the mean of G.hat</span>
median.G.hat=<span class="kw">apply</span>(G.hat,<span class="dv">1</span>,median) <span class="co">#the median of G.hat</span>
deciles.G.hat[<span class="dv">1</span>]=<span class="kw">quantile</span>(G.hat[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="fl">0.1</span>) <span class="co">#the deciles of G.hat</span>
deciles.G.hat[<span class="dv">2</span>]=<span class="kw">quantile</span>(G.hat[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="fl">0.1</span>)
deciles.G.hat[<span class="dv">3</span>]=<span class="kw">quantile</span>(G.hat[<span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="fl">0.1</span>) 
<span class="kw">round</span>(<span class="kw">rbind</span>(mean.G.hat,median.G.hat,deciles.G.hat),<span class="dv">3</span>) <span class="co">#output the mean,median and deciles of G.hat when x is standard lognormal,the uniform distribution and Bernoulli(0.1)</span></code></pre></div>
<pre><code>##                [,1]  [,2]  [,3]
## mean.G.hat    0.519 0.333 0.900
## median.G.hat  0.519 0.333 0.899
## deciles.G.hat 0.502 0.324 0.887</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#construct the density histograms of the replicates</span>
<span class="kw">hist</span>(G.hat[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="dt">main=</span><span class="st">&quot;density histogram of G.hat when x is standard lognormal&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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hgQU2sqWa6japWyD5m3VW+vDajedNHwjnZhZKI81pzbA3OySuU6C2pB6aw3siKZ6lG7eL0EBpbxgnlsFLq9Wb60noF5KFasMFLu1QUVzlVXRzAZZNlqrlvCY97oHutRIdH/lug3di8WB1wpF81hfoJiqGtAN1lmrLvRiuvk5iYCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAjorIAK3waufvwkfZRzd9XfX35empZR3nHYnvrtuAadE5Caz+K+WVYBJHeYGU/7TWneSmVH0MSjY3RGQCbzdgZIC6C0vHJjZUc2R0D2e5yJBrPf/GalZ6roGStyZvzNvyWgNFoXZz7ZHZLtfvP7jTKbHaDybKb9Rs6kF//knCf5v1fFqlPD3A5nNjtA5SqlPqIsgOy/ftLVLxSQNpsrIFmddF7VtqGWykoTCsiYzRCQnRxeApQIZH/vUILmCsg10iVAikmXKjZbQKXM25yqzZRVLLMTw+PIGweZEiSG2GtVB5cNSF9q5AOavA26eoplf2/GQZnh4b+LklbM5ggIq/hyxcvblqQEJBi0TQRfKiB/5eF3zQhmeTU/CREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEB/R87RmVC9iE7BgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="dt">main=</span><span class="st">&quot;density histogram of G.hat when x is uniform distribution&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat[<span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span>n],<span class="dt">main=</span><span class="st">&quot;density histogram of G.hat when x is Bernoulli(0.1)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="analysis-4" class="section level3">
<h3>Analysis:</h3>
<p>From the results,we can know that the mean,median and deciles of G.hat is approximately equal under the same distribution of x.But when x is different distribution,the value is different too.</p>
</div>
</div>
<div id="question-2-exercise-6.10" class="section level1">
<h1>Question 2 (Exercise 6.10)</h1>
<p>Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E(G)\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<p>Idea:</p>
<p>(1)Firstly,assume the <span class="math inline">\(\gamma \sim norm(E(\gamma),var(\gamma))\)</span>,use the method of Exercise 6.9 to estimate <span class="math inline">\(E(\hat{G})\)</span> and <span class="math inline">\(Var(\hat{G})\)</span>,and let <span class="math inline">\(E(\hat{G})\)</span> and <span class="math inline">\(Var(\hat{G})\)</span> replace <span class="math inline">\(E(\gamma),var(\gamma)\)</span>.</p>
<p>(2)construct a function to return the 95% confidence interval of gamma</p>
<p>(3)Then,repeat the estimation of confidence interval procedure 100 times,compute the times <span class="math inline">\(m\)</span> of the true <span class="math inline">\(\gamma\)</span> is in the confidence interval</p>
<p>(4)Lastly,the coverage rate <span class="math inline">\(CP=m/100\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#construct a function to return the 95% confidence interval of gamma</span>
CI=<span class="cf">function</span>(n,a,b,<span class="dt">alpha=</span><span class="fl">0.05</span>){
  t=<span class="kw">numeric</span>(n)
  g=<span class="kw">numeric</span>(n)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    x=<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n,a,b))
    mu.hat=<span class="kw">mean</span>(x)
    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      t[j]=(<span class="dv">2</span><span class="op">*</span>j<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[j]
    }
    g[i]=<span class="kw">mean</span>(t)<span class="op">/</span>(n<span class="op">*</span>mu.hat)
  }
  gamma.hat=<span class="kw">mean</span>(g)
  sd.hat=<span class="kw">sqrt</span>(<span class="kw">sum</span>((g<span class="op">-</span><span class="kw">mean</span>(g))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>n <span class="co">#estimate the standard deviation of gamma.hat</span>
  c=<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>sd.hat
  CI1=gamma.hat<span class="op">-</span>c <span class="co">#the confidence lower limit of gamma</span>
  CI2=gamma.hat<span class="op">+</span>c <span class="co">#the confidence upper limit of gamma</span>
  <span class="kw">c</span>(CI1,CI2)
}
<span class="kw">CI</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>) <span class="co">#construct an approximate 95% confidence interval of gamma when the parameters are given</span></code></pre></div>
<pre><code>## [1] 0.5187909 0.5205031</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#assess the coverage rate</span>
d=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">100</span>,<span class="dt">ncol=</span><span class="dv">2</span>)
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){
  d[k,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]=<span class="kw">CI</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)
}
CI1=d[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>]
CI2=d[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">2</span>]
<span class="co">#simulate the true value of gamma</span>
gamma=<span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>  <span class="co">#I get this value in an established paper</span>
gamma</code></pre></div>
<pre><code>## [1] 0.5204999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m=<span class="dv">0</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){
  <span class="cf">if</span>(gamma<span class="op">&lt;</span>CI1[i]) m=m
  <span class="cf">else</span>{
    <span class="cf">if</span>(gamma<span class="op">&gt;</span>CI2[i]) m=m
    <span class="cf">else</span>{
      m=m<span class="op">+</span><span class="dv">1</span>
    }
  }
}
m</code></pre></div>
<pre><code>## [1] 46</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CP=m<span class="op">/</span><span class="dv">100</span>
CP <span class="co">#the coverage rate </span></code></pre></div>
<pre><code>## [1] 0.46</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">1000</span>
mu=<span class="dv">0</span>
sigma=<span class="fl">0.9</span>
repsig=<span class="dv">400</span>
repmean=<span class="dv">100</span>
<span class="kw">system.time</span>({
  G=<span class="cf">function</span>(x,<span class="dt">mu=</span><span class="kw">mean</span>(x),<span class="dt">n=</span><span class="kw">length</span>(x))<span class="kw">sort</span>(x)<span class="op">%*%</span>(<span class="dv">1</span><span class="op">:</span>n<span class="op">*</span><span class="dv">2</span><span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n<span class="op">/</span>n<span class="op">/</span>mu
  mG=<span class="cf">function</span>(sig){mu=<span class="kw">mean</span>(<span class="kw">rlnorm</span>(repmean<span class="op">*</span>n,<span class="dv">0</span>,sig));<span class="kw">mean</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>repmean,<span class="cf">function</span>(...){<span class="kw">G</span>(<span class="kw">rlnorm</span>(n,<span class="dv">0</span>,sig),mu)}))}
  X=<span class="kw">rlnorm</span>(n,mu,sigma)
  <span class="kw">print</span>((<span class="dt">CI_sig=</span><span class="kw">sqrt</span>(<span class="kw">var</span>(<span class="kw">log</span>(X))<span class="op">/</span><span class="kw">qchisq</span>(<span class="kw">c</span>(<span class="fl">0.9875</span>,<span class="fl">0.0125</span>),<span class="dt">df=</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>))))
  rsig=<span class="kw">sqrt</span>(<span class="kw">var</span>(<span class="kw">log</span>(X))<span class="op">/</span><span class="kw">qchisq</span>(<span class="kw">runif</span>(repsig,<span class="fl">0.0125</span>,<span class="fl">0.9875</span>),<span class="dt">df=</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>))
  Gs=<span class="kw">sapply</span>(rsig,mG)
  <span class="kw">print</span>(<span class="kw">quantile</span>(Gs,<span class="kw">c</span>(<span class="fl">0.0125</span>,<span class="fl">0.9875</span>)))
})</code></pre></div>
<pre><code>## [1] 0.8393715 0.9279687
##     1.25%    98.75% 
## 0.4475353 0.4862066</code></pre>
<pre><code>##  用户  系统  流逝 
## 18.75  0.00 18.76</code></pre>
<div id="analysis-5" class="section level3">
<h3>Analysis:</h3>
<p>From the results,we can see that the coverage rate CP is 0.43 when conduct 100 times experiment.The CP is visibly smaller than the nominal level,then it is said to be liberal.</p>
</div>
</div>
<div id="question-3projects-6.b" class="section level1">
<h1>Question 3(Projects 6.B)</h1>
<p>Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman???s rank correlation coefficient <span class="math inline">\(\rho_{s}\)</span>, or Kendall???s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_{s}\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution (X,Y ) such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)</code></pre></div>
<pre><code>## Warning: 程辑包'MASS'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">9</span>),<span class="dv">2</span>,<span class="dv">2</span>)  
A=<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">1000</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma) <span class="co">#the sampled distribution is bivariate normal</span>
<span class="kw">plot</span>(A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">1</span>],A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">2</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">1</span>],A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">2</span>],<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)</code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  A[1:1000, 1] and A[1:1000, 2]
## t = 27.304, df = 998, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.6169262 0.6880128
## sample estimates:
##       cor 
## 0.6539103</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">1</span>],A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">2</span>],<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)</code></pre></div>
<pre><code>## 
##  Kendall's rank correlation tau
## 
## data:  A[1:1000, 1] and A[1:1000, 2]
## z = 21.49, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.4538458</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">1</span>],A[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dv">2</span>],<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>,<span class="dt">conf.level=</span><span class="fl">0.95</span>)</code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  A[1:1000, 1] and A[1:1000, 2]
## S = 60661000, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.6360311</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compute the power</span>
power=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">20</span>,<span class="dt">ncol=</span><span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) {
pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="dt">expr =</span> {
  Sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">9</span>),<span class="dv">2</span>,<span class="dv">2</span>)
  A=<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">100</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)
  ctest=<span class="kw">cor.test</span>(A[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>],A[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">2</span>],<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;pearson&quot;</span>,<span class="st">&quot;kendall&quot;</span>,<span class="st">&quot;spearman&quot;</span>),<span class="dt">conf.level=</span><span class="fl">0.95</span>)
  ctest<span class="op">$</span>p.value 
  } )
power[i,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]=<span class="kw">mean</span>(pvalues<span class="op">&lt;=</span><span class="fl">0.05</span>)
}</code></pre></div>
</div>
<div id="homework-5-2018112" class="section level1">
<h1>Homework 5 (2018/11/2)</h1>
</div>
<div id="question-1exercise-7.1" class="section level1">
<h1>Question 1(Exercise 7.1)</h1>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-10" class="section level1">
<h1>Answer</h1>
<p>Idea:</p>
<p>Compute a jackknife estimate of the bias and the standard error of the corre- lation statistic in Example 7.2 as follows:</p>
<p>(1)Let <span class="math inline">\(x=(x_{1},\dots,x_{n})\)</span> be an observed random sample, and idefine the <span class="math inline">\(i\)</span>th jackknife sample <span class="math inline">\(x_{(i)}\)</span> to be the subset of <span class="math inline">\(x\)</span> that leaves out the <span class="math inline">\(i^{th}\)</span> observation <span class="math inline">\(x_{i}\)</span>. That is,<span class="math display">\[x_{(i)}=(x_{1},\dots,x_{i},x_{i+1},\dots,x_{n})\]</span>.</p>
<p>(2)<span class="math inline">\(\hat{\theta}=cor(LAST,GPA)\)</span>,define the <span class="math inline">\(i^{th}\)</span> jackknife replicate <span class="math inline">\(\hat{\theta}=cor(LAST[-i],GPA[-i])\)</span>.</p>
<p>(3)The jackknife estimate of bias is <span class="math display">\[\hat{bias}_{jack}=(n-1)(\overline{\hat{\theta_{(.)}}}-\hat{\theta})\]</span>. where <span class="math inline">\(\hat{\theta_{(.)}}=\frac{1}{n}\sum_{i=1}^{n}\hat{\theta}_{i}\)</span>.</p>
<p>(4)A jackknife estimate of standard error is <span class="math display">\[\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}(\hat{\theta}_{(i)}-\overline{\hat{\theta_{(.)}}})^2}\]</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span>
LSAT=law<span class="op">$</span>LSAT
GPA=law<span class="op">$</span>GPA
n=<span class="kw">nrow</span>(law)
<span class="kw">system.time</span>({
  theta.hat=<span class="kw">cor</span>(LSAT,GPA) <span class="co">#the correlation estimate</span>
  <span class="kw">print</span>(theta.hat)

  <span class="co">#compute the jackknife replicates, leave-one-out estimates</span>
  theta.jack=<span class="kw">numeric</span>(n)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    theta.jack[i]=<span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])
  }
  bias=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
  <span class="kw">print</span>(bias)  <span class="co">#a jackknife estimate of the bias of the correlation statistic</span>
  se=<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">print</span>(se)  <span class="co">#a jackknife estimate of the standard error of the correlation statistic</span>
})</code></pre></div>
<pre><code>## [1] 0.7763745
## [1] -0.006473623
## [1] 0.1425186</code></pre>
<pre><code>## 用户 系统 流逝 
## 0.02 0.00 0.01</code></pre>
<div id="analysis-6" class="section level3">
<h3>Analysis</h3>
<p>The jackknife estimate of the bias and the standard error of the correlation statistic are -0.006473623 and 0.1425186.</p>
</div>
</div>
<div id="question-2exercise-7.5" class="section level1">
<h1>Question 2(Exercise 7.5)</h1>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-11" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(boot)   <span class="co">#for boot and boot.ci</span>
n=<span class="dv">100</span> <span class="co">#the times of bootstrap replicates</span>
<span class="kw">system.time</span>({
  x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)
  boot.mean=<span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])
  mean.hat=<span class="kw">mean</span>(x)
  boot.obj=<span class="kw">boot</span>(x,<span class="dt">statistic =</span> boot.mean,<span class="dt">R=</span>n)
  <span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))
  
})</code></pre></div>
<pre><code>## Warning in norm.inter(t, adj.alpha): extreme order statistics used as
## endpoints</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 100 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 23.3, 189.4 )   ( 18.1, 175.4 )  
## 
## Level     Percentile            BCa          
## 95%   ( 40.8, 198.0 )   ( 54.4, 243.2 )  
## Calculations and Intervals on Original Scale
## Some basic intervals may be unstable
## Some percentile intervals may be unstable
## Warning : BCa Intervals used Extreme Quantiles
## Some BCa intervals may be unstable</code></pre>
<pre><code>## 用户 系统 流逝 
## 0.02 0.00 0.02</code></pre>
<div id="analysis-7" class="section level3">
<h3>Analysis</h3>
<p>From the results,we can see that the 95% bootstrap confidence intervals for the mean time between failures by the standard normal, basic,percentile, and BCa methods respectively are <span class="math inline">\(( 30.6, 187.0 ), ( 4.4, 172.2 ), ( 43.9, 211.7 ), and ( 53.9, 226.3 ).\)</span></p>
<p>Because the BCa confidence intervals are transformation respecting and BCa intervals have second order accuracy, the bootstrap t confidence interval is second order accurate but not transformation respecting, the bootstrap percentile interval is transformation respecting but only first order accurate, the standard normal confidence interval is neither transformation respecting nor second order accurate, so the intervals may differ.Hence, the larger the order of accuracy, the faster the error is reduced.So the Bca method is more accurate.</p>
</div>
</div>
<div id="question-3-exercise-7.8" class="section level1">
<h1>Question 3 (Exercise 7.8)</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-12" class="section level1">
<h1>Answer</h1>
<p>Idea:</p>
<p>(1)the MLE of covariance is <span class="math display">\[\hat{\Sigma}=\frac{1}{n-1}(X-\mu)(X-\mu)^T,\]</span> where the <span class="math inline">\(X=scor^T=(x_{1},\dots,x_{n})\)</span> is the sample matrix, ,<span class="math inline">\(x_{i}=(x_{i1},\dots,x_{i5})^T\)</span>,<span class="math inline">\(\mu=(\mu_{1},\dots,\mu_{n}),n=1,\dots,88\)</span>, where <span class="math inline">\(\mu_{i}\)</span> is the rowmeans of <span class="math inline">\(scor^T\)</span>.</p>
<p>(2)obtain the jackknife estimates,first and idefine the <span class="math inline">\(i\)</span>th jackknife sample <span class="math inline">\(x_{(i)}\)</span> to be the subset of <span class="math inline">\(x\)</span> that leaves out the <span class="math inline">\(i^{th}\)</span> observation <span class="math inline">\(x_{i}\)</span>. That is,<span class="math display">\[Y_{i}=(x_{1},\dots,x_{-1},x_{i+1},\dots,x_{n})\]</span>.</p>
<p>(3)<span class="math inline">\(\hat{\Sigma}=\frac{1}{n-1}(X-\mu)(X-\mu)^T\)</span>,define the <span class="math inline">\(i^{th}\)</span> jackknife replicate <span class="math inline">\(\hat{\Sigma}=\frac{1}{n-1}(Y-\mu)(Y-\mu)^T\)</span>.</p>
<p>(4)Then,compute the eigenvalues of Sigma.hat under <span class="math inline">\(\hat{\Sigma}\)</span>,<span class="math inline">\(\hat{\lambda}_{1}&gt;\dots&gt;\hat{\lambda}_{5}\)</span>,then <span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{j=5}\hat{\lambda}_{j}}\)</span>.</p>
<p>(5)Then,compute the eigenvalues of Sigma.jack under <span class="math inline">\(\hat{\Sigma}_{jack}\)</span>,then compute the <span class="math inline">\(\hat{\theta}_{jack}\)</span>.</p>
<p>(6)The jackknife estimate of bias is <span class="math display">\[\hat{bias}_{jack}=(n-1)(\overline{\hat{\theta_{(.)}}}-\hat{\theta})\]</span>. where <span class="math inline">\(\hat{\theta_{(.)}}=\frac{1}{n}\sum_{i=1}^{n}\hat{\theta}_{jack(i)}\)</span>.</p>
<p>(7)A jackknife estimate of standard error is <span class="math display">\[\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}(\hat{\theta}_{(i)}-\overline{\hat{\theta_{(.)}}})^2}\]</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="co">#for the score data</span>
<span class="kw">library</span>(MASS)
scor.m=<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">as.numeric</span>(<span class="kw">t</span>(scor)), <span class="dv">5</span>, <span class="dv">88</span>)
n=<span class="kw">nrow</span>(scor)  <span class="co">#sample size</span>
mu=<span class="kw">rowMeans</span>(scor.m)
mu0=<span class="kw">matrix</span>(mu,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span>n)
<span class="kw">system.time</span>({
  sigma.hat=((scor.m<span class="op">-</span>mu0)<span class="op">%*%</span><span class="kw">t</span>(scor.m<span class="op">-</span>mu0))<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>) <span class="co"># the MLE of covariance matrix</span>
  ev.hat=<span class="kw">sort</span>(<span class="kw">eigen</span>(sigma.hat)<span class="op">$</span>values,<span class="dt">decreasing=</span>T)
  theta.hat=ev.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(ev.hat) 
  theta.hat <span class="co">#the estimate of theta</span>

  <span class="co">#obtain the jackknife estimates of bias and standard error of theta.hat</span>
  theta.jack=<span class="kw">numeric</span>(n)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    scor.m.jack=<span class="st"> </span>scor.m[,<span class="op">-</span>i]  <span class="co">#compute the jackknife replicates, leave-one-out estimates</span>
    mu1=<span class="kw">matrix</span>(mu,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span>n<span class="op">-</span><span class="dv">1</span>)
    sigma.jack=((scor.m.jack<span class="op">-</span>mu1)<span class="op">%*%</span><span class="kw">t</span>(scor.m.jack<span class="op">-</span>mu1))<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)
    ev.jack=<span class="kw">sort</span>(<span class="kw">eigen</span>(sigma.jack)<span class="op">$</span>values,<span class="dt">decreasing=</span>T)
    theta.jack[i]=ev.jack[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(ev.jack) 
  }
  theta.jack
  bias=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
  <span class="kw">print</span>(bias)  <span class="co">#a jackknife estimate of the bias </span>
  se=<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">print</span>(se)  <span class="co">#a jackknife estimate of the standard error </span>
  
})</code></pre></div>
<pre><code>## [1] 0.001044413
## [1] 0.04897464</code></pre>
<pre><code>## 用户 系统 流逝 
## 0.05 0.00 0.07</code></pre>
<div id="analysis-8" class="section level3">
<h3>Analysis</h3>
<p>The jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span> are 0.001044413 and 0.04897464.</p>
</div>
</div>
<div id="qusetion-4-exercise-7.11" class="section level1">
<h1>Qusetion 4 (Exercise 7.11)</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-13" class="section level1">
<h1>Answer</h1>
<p>Idea:</p>
<p>(1)Leave-two-out cross-validation</p>
<p>Leave-two-out cross-validation involves using 2 observations as the validation set and the remaining <span class="math inline">\(n-2\)</span> observations as the training set. This is repeated on all ways to cut the original sample on a validation set of p observations and a training set. LtO cross-validation requires training and validating the model <span class="math inline">\(m=c^{n}_{2}\)</span> times, where n is the number of observations in the original sample, and where <span class="math inline">\(m=c^{n}_{2}\)</span> is the binomial coefficient.</p>
<p>(2)Let <span class="math inline">\(y=magnetic,x=chemical\)</span>, For <span class="math inline">\(k = 1,\dots,n\)</span>, let observation <span class="math inline">\((x_{i},y_{i}),(x_{j},y_{j})\)</span> be the test point and use the remaining observations to fit the model.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Fit the model(s) using only the <span class="math inline">\(n ??? 2\)</span> observations in the training set</p></li>
<li><p>Compute the predicted response <span class="math display">\[\hat{y}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}*x_{i}\]</span>, <span class="math display">\[\hat{y}_{j}=\hat{\beta}_{0}+\hat{\beta}_{1}*x_{j}\]</span> for the test point.</p></li>
<li><p>Compute the squard prediction error <span class="math inline">\(spe[k]=\frac{(y_{i}-\hat{y}_{i})^2+(y_{j}-\hat{y}_{j})^2}{2}\)</span> .</p></li>
</ol>
<p>(3)Estimate the mean of the squared prediction errors <span class="math inline">\(\hat{\sigma}^2=\overline{spe}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(DAAG)</code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：'lattice'</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(ironslag)
n=<span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span>
m=n<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>  <span class="co"># leave-two-out cross validation require training and validating the model m times</span>
spe1=spe2=spe3=spe4=<span class="kw">numeric</span>(m)
<span class="co"># for leave-two-out cross validation</span>
<span class="co"># fit models on leave-two-out samples</span>
k=<span class="dv">0</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">-</span><span class="dv">1</span>)){
  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){
    k=k<span class="op">+</span><span class="dv">1</span>
    y=magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)] <span class="co">#leave-two-out </span>
    x=chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]
    
    J1=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
    yhat11=J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]   <span class="co">#the  estimate value of the i-th value</span>
    yhat12=J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]    <span class="co">#the  estimate value of the j-th value</span>
    spe1[k]=((magnetic[i]<span class="op">-</span>yhat11)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat12)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>   <span class="co">#the squared prediction error of the k-th </span>

    J2=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
    yhat21=J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span>
    yhat22=J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span>
    spe2[k]=((magnetic[i]<span class="op">-</span>yhat21)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat22)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

    J3=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
    logyhat31 =J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]
    logyhat32 =J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]
    yhat31=<span class="kw">exp</span>(logyhat31)
    yhat32=<span class="kw">exp</span>(logyhat32)
    spe3[k]=((magnetic[i]<span class="op">-</span>yhat31)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat32)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

    J4=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
    logyhat41 =J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i])
    logyhat42 =J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j])
    yhat41=<span class="kw">exp</span>(logyhat41)
    yhat42=<span class="kw">exp</span>(logyhat42)
    spe4[k]=((magnetic[i]<span class="op">-</span>yhat41)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat42)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>
    
  }
}
<span class="kw">c</span>(<span class="kw">mean</span>(spe1),<span class="kw">mean</span>(spe2),<span class="kw">mean</span>(spe3),<span class="kw">mean</span>(spe4))</code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</span>
J2</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co">#layout for graphs</span>
<span class="kw">plot</span>(J2<span class="op">$</span>fit, J2<span class="op">$</span>res) <span class="co">#residuals vs fitted values</span>
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co">#reference line</span>
<span class="kw">qqnorm</span>(J2<span class="op">$</span>res) <span class="co">#normal probability plot</span>
<span class="kw">qqline</span>(J2<span class="op">$</span>res) <span class="co">#reference line</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co">#restore display</span></code></pre></div>
<div id="analysis-9" class="section level3">
<h3>Analysis</h3>
<p>According to the prediction error criterion, Model 2, the quadratic model,would be the best fit for the data.Its results are consistent with those of the leave-one out method.From the QQ plot, we can see the Model 2 is similar to the sample distribution,</p>
</div>
</div>
<div id="homework-6-20181116" class="section level1">
<h1>Homework 6 (2018/11/16)</h1>
</div>
<div id="question-1-exercise-8.1" class="section level1">
<h1>Question 1 (Exercise 8.1)</h1>
<p>Implement the two-sample Cram´ er-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(nortest)
chickwts</code></pre></div>
<pre><code>##    weight      feed
## 1     179 horsebean
## 2     160 horsebean
## 3     136 horsebean
## 4     227 horsebean
## 5     217 horsebean
## 6     168 horsebean
## 7     108 horsebean
## 8     124 horsebean
## 9     143 horsebean
## 10    140 horsebean
## 11    309   linseed
## 12    229   linseed
## 13    181   linseed
## 14    141   linseed
## 15    260   linseed
## 16    203   linseed
## 17    148   linseed
## 18    169   linseed
## 19    213   linseed
## 20    257   linseed
## 21    244   linseed
## 22    271   linseed
## 23    243   soybean
## 24    230   soybean
## 25    248   soybean
## 26    327   soybean
## 27    329   soybean
## 28    250   soybean
## 29    193   soybean
## 30    271   soybean
## 31    316   soybean
## 32    267   soybean
## 33    199   soybean
## 34    171   soybean
## 35    158   soybean
## 36    248   soybean
## 37    423 sunflower
## 38    340 sunflower
## 39    392 sunflower
## 40    339 sunflower
## 41    341 sunflower
## 42    226 sunflower
## 43    320 sunflower
## 44    295 sunflower
## 45    334 sunflower
## 46    322 sunflower
## 47    297 sunflower
## 48    318 sunflower
## 49    325  meatmeal
## 50    257  meatmeal
## 51    303  meatmeal
## 52    315  meatmeal
## 53    380  meatmeal
## 54    153  meatmeal
## 55    263  meatmeal
## 56    242  meatmeal
## 57    206  meatmeal
## 58    344  meatmeal
## 59    258  meatmeal
## 60    368    casein
## 61    390    casein
## 62    379    casein
## 63    260    casein
## 64    404    casein
## 65    318    casein
## 66    352    casein
## 67    359    casein
## 68    216    casein
## 69    222    casein
## 70    283    casein
## 71    332    casein</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">sort</span>(<span class="kw">as.vector</span>(chickwts<span class="op">$</span>weight[chickwts<span class="op">$</span>feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y=<span class="kw">sort</span>(<span class="kw">as.vector</span>(chickwts<span class="op">$</span>weight[chickwts<span class="op">$</span>feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
n=<span class="kw">length</span>(x)
m=<span class="kw">length</span>(y)


R=<span class="dv">999</span> <span class="co">#number of replicates</span>
z=<span class="kw">c</span>(x, y) <span class="co">#pooled sample</span>
K=<span class="dv">1</span><span class="op">:</span><span class="dv">26</span>
D=<span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span>
fnx=<span class="kw">ecdf</span>(x)  <span class="co">#the ecdf of x</span>
fny=<span class="kw">ecdf</span>(y)   <span class="co">#the ecdf of y</span>
<span class="kw">options</span>(<span class="dt">warn =</span> <span class="op">-</span><span class="dv">1</span>)
D0=(<span class="kw">sum</span>((<span class="kw">fnx</span>(x)<span class="op">-</span><span class="kw">fny</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">fnx</span>(y)<span class="op">-</span><span class="kw">fny</span>(y))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>((m<span class="op">*</span>n)<span class="op">/</span>((m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>))  <span class="co">#statistic</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){
  k=<span class="kw">sample</span>(K,<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">FALSE</span>) <span class="co">#permutation</span>
  x1=z[k]
  y1=z[<span class="op">-</span>k]
  D[i]=(<span class="kw">sum</span>((<span class="kw">fnx</span>(x1)<span class="op">-</span><span class="kw">fny</span>(x1))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">fnx</span>(y1)<span class="op">-</span><span class="kw">fny</span>(y1))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>((m<span class="op">*</span>n)<span class="op">/</span>((m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>))  <span class="co">#statistic</span>
}

<span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">0</span>)
p=<span class="kw">mean</span>(D<span class="op">&gt;</span>D0)
p</code></pre></div>
<pre><code>## [1] 0.2712713</code></pre>
</div>
<div id="analysis-10" class="section level1">
<h1>Analysis</h1>
<p>From the results,p=0.2712 is significent,so we should reject the <span class="math inline">\(H_{0}\)</span>.</p>
</div>
<div id="qusetion-2" class="section level1">
<h1>Qusetion 2</h1>
<p>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>Note: The parameters should be choosen such that the powers are distinguishable (say, range from 0.3 to 0.9).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(RANN)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(Ball)</code></pre></div>
<pre><code>## 载入需要的程辑包：gam</code></pre>
<pre><code>## 载入需要的程辑包：splines</code></pre>
<pre><code>## 载入需要的程辑包：foreach</code></pre>
<pre><code>## Loaded gam 1.16</code></pre>
<pre><code>## 载入需要的程辑包：survival</code></pre>
<pre><code>## 
## 载入程辑包：'survival'</code></pre>
<pre><code>## The following object is masked from 'package:DAAG':
## 
##     lung</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     aml</code></pre>
<pre><code>## 载入需要的程辑包：mvtnorm</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)


<span class="co">#(1) Unequal variances and equal expectations</span>

m=<span class="dv">40</span> <span class="co">#number of replicates</span>
R=<span class="dv">999</span>
k=<span class="dv">3</span>



Tn=<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
  n1=sizes[<span class="dv">1</span>]
  n2 =<span class="st"> </span>sizes[<span class="dv">2</span>]
  n =n1 <span class="op">+</span><span class="st"> </span>n2
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);
  z =z[ix, ];
  NN =<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
  block1=<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
  block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
  i1 =<span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); 
  i2=<span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}



eqdist.nn=<span class="cf">function</span>(z,sizes,k){
boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p1.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">4</span>) <span class="co">#generate a sample x~N(4,4)</span>
  y=<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>) <span class="co">#generate a sample y~n(4,1)</span>
  z=<span class="kw">c</span>(x,y)
  n1=<span class="kw">length</span>(x)
  n2=<span class="kw">length</span>(y)
  N=<span class="kw">c</span>(n1,n2)
  p1.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p1.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p1.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha=<span class="fl">0.1</span>
pow1=<span class="kw">colMeans</span>(p1.values<span class="op">&lt;</span>alpha)
pow1</code></pre></div>
<pre><code>## [1] 0.725 0.675 0.900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(pow1)=<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;energy&quot;</span>, <span class="st">&quot;ball&quot;</span>)
<span class="kw">barplot</span>(pow1)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6OgA6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQkGaQ27aQ2/+2ZgC2tma225C2//++vr7bkDrb////tmb/25D//7b//9v///+WWpOzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGpUlEQVR4nO2diXLaSBRFj5PYsxjPhIyZhdjA/3/lqFsIb4iHzHKv4J2q2CpV6/XRRStqOaySnaAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAu4g1rAHdQC7qAWcAe1gDuoBdxBLeAOagF3UAscAYYxsPgpjM8M/w2BgcUHtZ7B7XLafArfh/VyWnwCmn/72WR0u1otJvfDujkpNgEtp00sTzePqzYqG2wCWkyaPevpy7+r7qcJNgHlFhSxOQbVqGzwCSjPYuMkAwpwDGieZ7FhVT55o3McRhDQqcrt2WkGFHTqE1A9xTf0HoEG9n4cfAKas74+fKLnQnFg78fBJqBX1899txoDez8ONgHVm9WWvpvVgb0fB5uAcguKmHf3YHkM6mExac9ivV92DOz9OBgFtGe5kz5m2NLp+AI6pfGWTjOgoNMMKOg0Awo6zYCCTq8moE+e/a4ooM8tlwEFy2VAwXIZULBcBhQslwEFy2VAwXIZULDcCAJ6d/GWAQXlMqCgXAYUlMuAgnIZUFAuAwrKZUBBuQwoKJcBBeUyoKBcBhSUy4CCchlQUO7aA3q+630TgYOMxx5QN/hlxzDO6w6oGzeVW1Avi0kZOpUB7WB285gB7WTOfQa0k+e7rxnQTpbT/hcOOcj4QgKKy2VAvS/UcZDxBQX0vko+FxtULgMKyl1vQHu+UHe1Ae37Qt21BrT361DXGtDeL9Rda0C5BUXs+0Ld1Qa07wt11xvQnuUyoKBcBhSUy4CCchlQUC4DCsplQEG5DCgolwEF5TKgoFwGFJTLgIJyGVBQLgMKymVAQbkM6EOVfHA4qFwGFJTLgIJyGVBQLgMKymVAQbkMKCiXAQXlMqCgXAYUlMuAgnIZUFAuAwrKXW9AOUZxNzlGcTc5wiwgxygG5BYUkWMUI3KM4qFwkHEGFBhfUED5Qt3AKu+ei33uL4t/drnPdrffqh0czoWDWsAdBrUOb1YvD4Y0jm9WLw8GtN3jVuPyYEDbPW5WLw8GtM0tKCK+Wb08GNQ6vFm9PFALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDqfuYDltv52dffv5avJUvX38S86LyfdXXxUPh0N09mE55bb8rgFtJk/V2ygD+vrL42od0GbyVL2NMqDbedluakCbyZ7Gcyjfdi8mf06o3393Mx5+lIeVM7j5cfM4K0VqpQ883/1xR/uFedO4lBhDQFWwDaib3N52Xv9g/n2zUs3EfP2vnVEWmTUZPXHzWJ45LadbV/r5br3EqqRYFh9DQPUhURtQN7m16WJSPvpm9etEs7d8mLGq/+tAWeHnurN+oGZTBucsHh7bJUYRUHmgtg5oPbm16dNNWekaTLtvvJ3RPqws82a3fQ/m2hDb5ZqtjZEEVNZtHdB6cmvTp/UAnpeA3syYbwIqNbY/mGs3rPKzOXp9+WcsW1CzY9x3AbWTW5uuP/j1M+7NFtTNeNmCFg9/PWzdw162oDoxml2sfKa/dgHVya1NNyvSBfR2Rrvy5cC7nP7WU2J9DPr2s6b5NJpdrJx0u4Dq5Pa2ZeW7o3AN5c2MzVns1Tic99SzWMml3Xi4H01A5UT9arKn8bwdnLUJ6M2Memnz5e+yafScw7rroPUVVHPFVLP1DujY1H3n+fezDQ7gXB0dTj0GtZdG8/MNLuFsPR1OPevXo/UZR5dwtp5GCmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawB3UAu6gFnAHtYA7qAXcQS3gDmoBd1ALuINawJ3/AQkdb8r9aBQCAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(2) Unequal variances and unequal expectations</span>

m=<span class="dv">40</span>  <span class="co">#number of replicates</span>
R=<span class="dv">999</span>
k=<span class="dv">3</span>
z=<span class="kw">c</span>(x,y) <span class="co"># pooled sample</span>
eqdist.nn=<span class="cf">function</span>(z,sizes,k){
boot.obj =<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p2.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">4</span>) <span class="co">#generate a sample x~N(4,4)</span>
  y=<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">1</span>) <span class="co">#generate a sample y~N(2,1)</span>
  z=<span class="kw">c</span>(x,y)
  n1=<span class="kw">length</span>(x)
  n2=<span class="kw">length</span>(y)
  N=<span class="kw">c</span>(n1,n2)
  p2.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p2.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p2.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha=<span class="fl">0.1</span>
pow2=<span class="kw">colMeans</span>(p2.values<span class="op">&lt;</span>alpha)
pow2</code></pre></div>
<pre><code>## [1] 0.650 0.825 0.900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(pow2)=<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;energy&quot;</span>, <span class="st">&quot;ball&quot;</span>)
<span class="kw">barplot</span>(pow2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</span>

m=<span class="dv">40</span> <span class="co">#number of replicates</span>
R=<span class="dv">999</span>
k=<span class="dv">3</span>
z=<span class="kw">c</span>(x,y) <span class="co">#poled sample</span>
eqdist.nn=<span class="cf">function</span>(z,sizes,k){
boot.obj =<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p3.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rt</span>(<span class="dv">10</span>,<span class="dv">1</span>)  <span class="co">#generate a sample x~t(1)</span>
  y=<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="kw">rnorm</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>)) <span class="co">#generate a bimodel  sample y which is a mixture of N(2,1) and N(4,4)</span>
  z=<span class="kw">c</span>(x,y)
  n1=<span class="kw">length</span>(x)
  n2=<span class="kw">length</span>(y)
  N=<span class="kw">c</span>(n1,n2)
  p3.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p3.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p3.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha=<span class="fl">0.1</span>
pow3=<span class="kw">colMeans</span>(p3.values<span class="op">&lt;</span>alpha)
pow3</code></pre></div>
<pre><code>## [1] 0.80 0.85 0.85</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(pow3)=<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;energy&quot;</span>, <span class="st">&quot;ball&quot;</span>)
<span class="kw">barplot</span>(pow3)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(4)Unbalanced samples (say, 1 case versus 10 controls)</span>

m=<span class="dv">40</span>  <span class="co">#number of replicates</span>
R=<span class="dv">999</span>
k=<span class="dv">3</span>
z=<span class="kw">c</span>(x,y) <span class="co">#pooled sample</span>
eqdist.nn =<span class="cf">function</span>(z,sizes,k){
boot.obj=<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p4.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rexp</span>(<span class="dv">10</span>,<span class="dv">4</span>)  <span class="co">#generate a sample x~exp(4)</span>
  y=<span class="kw">rf</span>(<span class="dv">15</span>,<span class="dv">1</span>,<span class="dv">2</span>)  <span class="co">#generate a sample y~F(1,2),and the numbers of them are different</span>
  z=<span class="kw">c</span>(x,y)
  n1=<span class="kw">length</span>(x)
  n2=<span class="kw">length</span>(y)
  N=<span class="kw">c</span>(n1,n2)
  p4.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p4.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p4.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha=<span class="fl">0.1</span>
pow4=<span class="kw">colMeans</span>(p4.values<span class="op">&lt;</span>alpha)
pow4</code></pre></div>
<pre><code>## [1] 0.55 0.60 0.90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(pow4)=<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;energy&quot;</span>, <span class="st">&quot;ball&quot;</span>)
<span class="kw">barplot</span>(pow4)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-7-20181123" class="section level1">
<h1>Homework 7 (2018/11/23)</h1>
</div>
<div id="question-1-2" class="section level1">
<h1>Question 1</h1>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
Gelman.Rubin=<span class="cf">function</span>(psi) {
<span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
<span class="co"># for chain in i-th row of X</span>
psi =<span class="kw">as.matrix</span>(psi)
n=<span class="kw">ncol</span>(psi)
k=<span class="kw">nrow</span>(psi)
psi.means=<span class="kw">rowMeans</span>(psi) <span class="co">#row means</span>
B=n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span>
psi.w=<span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span>
W=<span class="kw">mean</span>(psi.w) <span class="co">#within est.</span>
v.hat=W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span>
r.hat=v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span>
<span class="kw">return</span>(r.hat)
}


  f=<span class="cf">function</span>(theta,x){
    f1=(<span class="fl">0.5</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>x[<span class="dv">1</span>]
    f2=((<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>x[<span class="dv">2</span>]
    f3=((<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>x[<span class="dv">3</span>]
    f4=(theta<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>x[<span class="dv">4</span>]
    <span class="cf">if</span>(theta<span class="op">&gt;=</span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>theta<span class="op">&lt;</span><span class="dv">1</span>)
      <span class="kw">return</span>(f1<span class="op">*</span>f2<span class="op">*</span>f3<span class="op">*</span>f4)
    <span class="cf">else</span>{
      <span class="kw">return</span>(<span class="dv">0</span>)
      }
  }
  
  
unif.chain=<span class="cf">function</span>(m,p1){
  <span class="co">#generates a Metropolis chain for unif(0,1)</span>
  <span class="co">#with unif(-1,1) proposal distribution</span>
  <span class="co">#and starting value X1</span>
  p=<span class="kw">rep</span>(<span class="dv">0</span>, m)
  p[<span class="dv">1</span>]=p1
  u=<span class="kw">runif</span>(m)
  y=<span class="kw">runif</span>(m,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#the proposal distribution</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
    theta=p[i<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>y[i]
    num=<span class="st"> </span><span class="kw">f</span>(theta,x)
    den=<span class="kw">f</span>(p[i<span class="op">-</span><span class="dv">1</span>],x)
    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>num<span class="op">/</span>den)
      p[i]=theta
    <span class="cf">else</span>{
      p[i]=p[i<span class="op">-</span><span class="dv">1</span>]
    }
    }
<span class="kw">return</span>(p)
}
  
  
m=<span class="dv">5000</span> <span class="co">#the number of replicates</span>
b=<span class="dv">4700</span> <span class="co">#burn-in length</span>
t=<span class="dv">4</span> <span class="co">#number of chains to generate</span>
x=<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
p0=<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>) <span class="co">#choose overdispersed initial values</span>


<span class="co">#generate the chains</span>
P=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>t,<span class="dt">ncol=</span>m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>t)
  P[i,]=<span class="kw">unif.chain</span>(m,p0[i])

<span class="co">#compute diagnostic statistics</span>
psi=<span class="kw">t</span>(<span class="kw">apply</span>(P, <span class="dv">1</span>, cumsum))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))
psi[i,]=psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.059509</code></pre>
</div>
<div id="analysis-11" class="section level1">
<h1>Analysis</h1>
<p>From the results, we can see that the <span class="math inline">\(\hat{r}\)</span> is <span class="math inline">\(1.0595&lt;1.2\)</span>. It shows that the chains have approximately converged to the target distribution.</p>
</div>
<div id="question-2exercise-11.4" class="section level1">
<h1>Question 2(Exercise 11.4)</h1>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)\]</span> and <span class="math display">\[S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2}k}{k+1-a^{2}}}\right)\]</span>,for <span class="math inline">\(k=4:25,100,500,1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(rootSolve)</code></pre></div>
<pre><code>## Warning: 程辑包'rootSolve'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)  <span class="co">#the degrees</span>
n=<span class="kw">length</span>(k)
solution=<span class="kw">numeric</span>(n)
s=<span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  s1=<span class="cf">function</span>(a){
    q=<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
    <span class="kw">pt</span>(q,<span class="dt">df=</span>k[i]<span class="op">-</span><span class="dv">1</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>,<span class="dt">log.p =</span> <span class="ot">FALSE</span>)
  }
  s2=<span class="cf">function</span>(a){
    q=<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
    <span class="kw">pt</span>(q,<span class="dt">df=</span>k[i],<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>,<span class="dt">log.p =</span> <span class="ot">FALSE</span>)
  }
  f=<span class="cf">function</span>(a){
    <span class="kw">s1</span>(a)<span class="op">-</span><span class="kw">s2</span>(a)
  }
  solution[i]=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.0001</span>))<span class="op">$</span>root  <span class="co">#the abscissa of the intersection points</span>
  s[i]=<span class="kw">s1</span>(solution[i])  <span class="co">#the ordinate of the intersection points</span>
  }
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(solution,s),<span class="dv">5</span>))</code></pre></div>
<pre><code>##             [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]
## solution 1.49210 1.53355 1.56277 1.58442 1.60119 1.61452 1.62539 1.63441
## s        0.07382 0.06628 0.06156 0.05836 0.05603 0.05427 0.05289 0.05179
##             [,9]   [,10]   [,11]   [,12]   [,13]   [,14]   [,15]   [,16]
## solution 1.64200 1.64856 1.65417 1.65910 1.66345 1.66729 1.67074 1.67384
## s        0.05088 0.05011 0.04947 0.04892 0.04843 0.04801 0.04764 0.04731
##            [,17]   [,18]   [,19]   [,20]   [,21]   [,22]   [,23]    [,24]
## solution 1.67659 1.67914 1.68146 1.68359 1.68554 1.68735 1.72060 22.36058
## s        0.04702 0.04675 0.04650 0.04628 0.04608 0.04590 0.04267  0.00000
##             [,25]
## solution 31.62268
## s         0.00000</code></pre>
</div>
<div id="analysis-12" class="section level1">
<h1>Analysis</h1>
<p>From the results ,we can see the abscissa of the intersection points is in 1~2 when <span class="math inline">\(k&lt;500\)</span>.When <span class="math inline">\(k=500,1000\)</span>,there are infinite intersections.</p>
</div>
<div id="homework-8-20181130" class="section level1">
<h1>Homework 8 (2018/11/30)</h1>
</div>
<div id="question-1-exercise-11.6" class="section level1">
<h1>Question 1 (Exercise 11.6)</h1>
<p>Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty\]</span>. where <span class="math inline">\(\theta&gt;0\)</span>. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
f=<span class="cf">function</span>(x,theta,eta){
  <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}
res=<span class="kw">integrate</span>(f,<span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>,<span class="dt">upper=</span><span class="dv">6</span>,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span><span class="dv">1</span>,<span class="dt">eta=</span><span class="dv">1</span>)
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(res<span class="op">$</span>value,<span class="kw">pcauchy</span>(<span class="dv">6</span>,<span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)),<span class="dv">5</span>))</code></pre></div>
<pre><code>##         [,1]
## [1,] 0.93717
## [2,] 0.94743</code></pre>
</div>
<div id="analysis-13" class="section level1">
<h1>Analysis</h1>
<p>From the result,we can see the value from this method is 0.93717,the value from the R function pcauchy is 0.94743, they are very colsed.</p>
</div>
<div id="question-2-2" class="section level1">
<h1>Question 2</h1>
<p>A-B-O blood type problem</p>
<p>Let the three alleles be A, B and O.</p>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th align="right">AA</th>
<th align="center">BB</th>
<th align="right">OO</th>
<th align="center">AO</th>
<th align="right">BO</th>
<th align="center">AB</th>
<th align="right">AA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frenquency</td>
<td align="right"><span class="math inline">\(p^{2}\)</span></td>
<td align="center"><span class="math inline">\(q^{2}\)</span></td>
<td align="right"><span class="math inline">\(r^{2}\)</span></td>
<td align="center">2pr</td>
<td align="right">2qr</td>
<td align="center">2pq</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Count</td>
<td align="right">nAA</td>
<td align="center">nBB</td>
<td align="right">nOO</td>
<td align="center">nAO</td>
<td align="right">nBO</td>
<td align="center">nAB</td>
<td align="right">nAA</td>
</tr>
</tbody>
</table>
<p>Observed data: <span class="math display">\[n_{A.}=n_{AA}+n_{AO}=28(A-type)\]</span>, <span class="math display">\[n_{B.}=n_{BB}+n_{BO}=24(B-type)\]</span>, <span class="math display">\[n_{OO}=41(O-type)\]</span>, <span class="math display">\[n_{AB}=70(AB-type)\]</span>.</p>
<p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>Record the maximum likelihood values in M-steps,are they increasing?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ABOexpect=<span class="cf">function</span>(nA,nB,p,q,r) {
    nAA=nA <span class="op">*</span><span class="st"> </span>p <span class="op">/</span><span class="st"> </span>(p <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>r)
    nAO=nA <span class="op">-</span><span class="st"> </span>nAA
    nBB=nB <span class="op">*</span><span class="st"> </span>q <span class="op">/</span><span class="st"> </span>(q <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>r)
    nBO=nB <span class="op">-</span><span class="st"> </span>nBB
    N=<span class="kw">list</span>(<span class="dt">AA=</span>nAA,<span class="dt">AO=</span>nAO,<span class="dt">BB=</span>nBB,<span class="dt">BO=</span>nBO)
  }
  
  ABOmaximize=<span class="cf">function</span>(nAA,nAO,nBB,nBO,nAB,nO) {
    p=(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAA <span class="op">+</span><span class="st"> </span>nAO <span class="op">+</span><span class="st"> </span>nAB) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(nA <span class="op">+</span><span class="st"> </span>nB <span class="op">+</span><span class="st"> </span>nO <span class="op">+</span><span class="st"> </span>nAB))
    q=(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBB <span class="op">+</span><span class="st"> </span>nBO <span class="op">+</span><span class="st"> </span>nAB) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(nA <span class="op">+</span><span class="st"> </span>nB <span class="op">+</span><span class="st"> </span>nO <span class="op">+</span><span class="st"> </span>nAB))
    r=<span class="st"> </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>p <span class="op">-</span><span class="st"> </span>q
    L=<span class="kw">list</span>(<span class="dt">p=</span>p,<span class="dt">q=</span>q,<span class="dt">r=</span>r)
  }
  
  <span class="co">#initial guess</span>
  p=<span class="fl">0.3</span>
  q=<span class="fl">0.2</span>
  r=<span class="fl">0.5</span>
  ## Observed data (counts of people with the four blood groups)
  nA =<span class="dv">28</span>
  nB=<span class="dv">24</span>
  nAB=<span class="dv">41</span>
  nO=<span class="dv">40</span>
  
  ## Set up iteration
  iter=<span class="dv">1</span>
  diff=<span class="dv">1</span>
  tol=<span class="fl">0.0001</span> ## tolerance
  
  <span class="cf">while</span> (diff <span class="op">&gt;</span><span class="st"> </span>tol) {
    E=<span class="kw">ABOexpect</span>(nA,nB,p,q,r)
    M=<span class="kw">ABOmaximize</span>(E<span class="op">$</span>AA,E<span class="op">$</span>AO,E<span class="op">$</span>BB,E<span class="op">$</span>BO,nAB,nO)
    diff=<span class="kw">abs</span>(M<span class="op">$</span>p <span class="op">-</span><span class="st"> </span>p) <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(M<span class="op">$</span>q <span class="op">-</span><span class="st"> </span>q) <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(M<span class="op">$</span>r <span class="op">-</span>r)
    p=M<span class="op">$</span>p
    q=M<span class="op">$</span>q
    r=M<span class="op">$</span>r
    <span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;iter:%d, diff:%.2f</span><span class="ch">\n</span><span class="st">&quot;</span>,iter,diff))
    iter=iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }</code></pre></div>
<pre><code>## iter:1, diff:0.12
## iter:2, diff:0.01
## iter:3, diff:0.00
## iter:4, diff:0.00
## iter:5, diff:0.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;p=%.4f,q=%.4f, r=%.4f</span><span class="ch">\n</span><span class="st">&quot;</span>,p,q,r))</code></pre></div>
<pre><code>## p=0.2847,q=0.2649, r=0.4505</code></pre>
</div>
<div id="analysis-14" class="section level1">
<h1>Analysis</h1>
<p>From the result, we can see the MLE of the <span class="math inline">\(p,q\)</span> are respectivly 0.2847, 0.2649.</p>
</div>
<div id="homework-9-2018127" class="section level1">
<h1>Homework 9 (2018/12/7)</h1>
</div>
<div id="question-1-page-204-exercise-3" class="section level1">
<h1>Question 1 (Page 204 Exercise 3)</h1>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas=list(</p>
<p>mpg~disp,</p>
<p>mpg~I(1/disp),</p>
<p>mpg~disp+wt,</p>
<p>mpg~I(1/disp)+wt</p>
<p>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(base)
 formulas=<span class="kw">list</span>(
      mpg <span class="op">~</span><span class="st"> </span>disp,
      mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
      mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
      mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
    )
 
 
<span class="co">#for loops</span>
out_formulas=<span class="kw">vector</span>(<span class="st">'list'</span>, <span class="kw">length</span>(formulas))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {
  out_formulas[[i]]=<span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)
  }
out_formulas</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(formulas, lm, mtcars)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-2-exercise-4" class="section level1">
<h1>Question 2 (Exercise 4)</h1>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply() . Can you do it without an anonymous function?</p>
<p>bootstraps=lapply(1:10, function(i) {</p>
<p>rows=sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
bootstraps=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
  rows=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
  mtcars[rows, ]
}
  )
 
 
<span class="co">#for loops</span>
out_bootstraps=<span class="kw">vector</span>(<span class="st">'list'</span>, <span class="kw">length</span>(bootstraps))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)) {
  out_bootstraps[[i]]=<span class="kw">lm</span>(mpg<span class="op">~</span>disp, <span class="dt">data =</span> bootstraps[[i]])
  }
out_bootstraps</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.05769     -0.03647  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11683     -0.04082  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.57385     -0.02937  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.28313     -0.03724  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.60253     -0.04562  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7208      -0.0383  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.11226     -0.03166  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34297     -0.04015  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.52186     -0.02975  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.06815     -0.03533</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg<span class="op">~</span>disp)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.05769     -0.03647  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11683     -0.04082  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.57385     -0.02937  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.28313     -0.03724  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.60253     -0.04562  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7208      -0.0383  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.11226     -0.03166  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34297     -0.04015  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.52186     -0.02975  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.06815     -0.03533</code></pre>
</div>
<div id="question-3-exercise-5" class="section level1">
<h1>Question 3 (Exercise 5)</h1>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^{2}\)</span> using the function below.</p>
<p>rsq=function(mod) summary(mod)$r.squared</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
rsq=<span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared

<span class="co">#Exercise 3</span>
<span class="kw">lapply</span>(out_formulas, rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Exercise 4</span>
<span class="kw">lapply</span>(out_bootstraps, rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.6606581
## 
## [[2]]
## [1] 0.8160798
## 
## [[3]]
## [1] 0.5806448
## 
## [[4]]
## [1] 0.7407087
## 
## [[5]]
## [1] 0.7589143
## 
## [[6]]
## [1] 0.6561107
## 
## [[7]]
## [1] 0.6021043
## 
## [[8]]
## [1] 0.6888394
## 
## [[9]]
## [1] 0.5989015
## 
## [[10]]
## [1] 0.723953</code></pre>
</div>
<div id="question-4-page-214-exercise-3" class="section level1">
<h1>Question 4 (Page 214 Exercise 3)</h1>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials=replicate(100,t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE)</p>
<p>Extra challenge: get rid of the anonymous function by using[[ directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
p=<span class="kw">numeric</span>(<span class="dv">100</span>)
trials=<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)

<span class="co">#for loops</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){
  p[i]=trials[[i]]<span class="op">$</span>p.value
}
p</code></pre></div>
<pre><code>##   [1] 0.125949930 0.800930340 0.952855296 0.452959855 0.483083494
##   [6] 0.320611150 0.706780317 0.063119508 0.621092522 0.162276154
##  [11] 0.820427933 0.053095862 0.914712292 0.792200487 0.390189150
##  [16] 0.538640844 0.143988430 0.788393427 0.672267752 0.216269737
##  [21] 0.534646674 0.809214595 0.960266963 0.569466705 0.632178255
##  [26] 0.582700745 0.254983356 0.282179271 0.005098396 0.162075913
##  [31] 0.877783340 0.654074362 0.169752059 0.754440969 0.764179721
##  [36] 0.026793925 0.114713268 0.028496672 0.598991648 0.885239097
##  [41] 0.719211331 0.409696973 0.847167535 0.764438221 0.418863595
##  [46] 0.519132187 0.463910875 0.286785195 0.875030871 0.241068098
##  [51] 0.838739962 0.348638336 0.622633185 0.232606824 0.398974335
##  [56] 0.970218660 0.860375193 0.909101881 0.851096482 0.523397015
##  [61] 0.746860279 0.764894312 0.025411594 0.019036587 0.397989350
##  [66] 0.714919878 0.631471636 0.110724341 0.927143289 0.041990454
##  [71] 0.208117904 0.607178718 0.906974079 0.554576397 0.194404278
##  [76] 0.771678543 0.396686801 0.803958799 0.768941702 0.994186553
##  [81] 0.194123673 0.316046848 0.415575715 0.619270683 0.295629509
##  [86] 0.942948679 0.607585865 0.718018866 0.761453123 0.120281420
##  [91] 0.577128336 0.019315507 0.483007741 0.108496205 0.469918314
##  [96] 0.011282410 0.231024499 0.955230239 0.964944823 0.281065452</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#sapply</span>
x=<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)
p1=<span class="kw">sapply</span>(trials,<span class="cf">function</span>(mod) mod<span class="op">$</span>p.value)
p1</code></pre></div>
<pre><code>##   [1] 0.125949930 0.800930340 0.952855296 0.452959855 0.483083494
##   [6] 0.320611150 0.706780317 0.063119508 0.621092522 0.162276154
##  [11] 0.820427933 0.053095862 0.914712292 0.792200487 0.390189150
##  [16] 0.538640844 0.143988430 0.788393427 0.672267752 0.216269737
##  [21] 0.534646674 0.809214595 0.960266963 0.569466705 0.632178255
##  [26] 0.582700745 0.254983356 0.282179271 0.005098396 0.162075913
##  [31] 0.877783340 0.654074362 0.169752059 0.754440969 0.764179721
##  [36] 0.026793925 0.114713268 0.028496672 0.598991648 0.885239097
##  [41] 0.719211331 0.409696973 0.847167535 0.764438221 0.418863595
##  [46] 0.519132187 0.463910875 0.286785195 0.875030871 0.241068098
##  [51] 0.838739962 0.348638336 0.622633185 0.232606824 0.398974335
##  [56] 0.970218660 0.860375193 0.909101881 0.851096482 0.523397015
##  [61] 0.746860279 0.764894312 0.025411594 0.019036587 0.397989350
##  [66] 0.714919878 0.631471636 0.110724341 0.927143289 0.041990454
##  [71] 0.208117904 0.607178718 0.906974079 0.554576397 0.194404278
##  [76] 0.771678543 0.396686801 0.803958799 0.768941702 0.994186553
##  [81] 0.194123673 0.316046848 0.415575715 0.619270683 0.295629509
##  [86] 0.942948679 0.607585865 0.718018866 0.761453123 0.120281420
##  [91] 0.577128336 0.019315507 0.483007741 0.108496205 0.469918314
##  [96] 0.011282410 0.231024499 0.955230239 0.964944823 0.281065452</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#anonymous function</span>
p2=<span class="kw">sapply</span>(trials,<span class="st">'[['</span>,<span class="st">'p.value'</span>)
p2</code></pre></div>
<pre><code>##   [1] 0.125949930 0.800930340 0.952855296 0.452959855 0.483083494
##   [6] 0.320611150 0.706780317 0.063119508 0.621092522 0.162276154
##  [11] 0.820427933 0.053095862 0.914712292 0.792200487 0.390189150
##  [16] 0.538640844 0.143988430 0.788393427 0.672267752 0.216269737
##  [21] 0.534646674 0.809214595 0.960266963 0.569466705 0.632178255
##  [26] 0.582700745 0.254983356 0.282179271 0.005098396 0.162075913
##  [31] 0.877783340 0.654074362 0.169752059 0.754440969 0.764179721
##  [36] 0.026793925 0.114713268 0.028496672 0.598991648 0.885239097
##  [41] 0.719211331 0.409696973 0.847167535 0.764438221 0.418863595
##  [46] 0.519132187 0.463910875 0.286785195 0.875030871 0.241068098
##  [51] 0.838739962 0.348638336 0.622633185 0.232606824 0.398974335
##  [56] 0.970218660 0.860375193 0.909101881 0.851096482 0.523397015
##  [61] 0.746860279 0.764894312 0.025411594 0.019036587 0.397989350
##  [66] 0.714919878 0.631471636 0.110724341 0.927143289 0.041990454
##  [71] 0.208117904 0.607178718 0.906974079 0.554576397 0.194404278
##  [76] 0.771678543 0.396686801 0.803958799 0.768941702 0.994186553
##  [81] 0.194123673 0.316046848 0.415575715 0.619270683 0.295629509
##  [86] 0.942948679 0.607585865 0.718018866 0.761453123 0.120281420
##  [91] 0.577128336 0.019315507 0.483007741 0.108496205 0.469918314
##  [96] 0.011282410 0.231024499 0.955230239 0.964944823 0.281065452</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compare the consequence of the for loops and sapply</span>
<span class="kw">identical</span>(p,p1) </code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(p,p2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="question-5-page-214-exercise-6" class="section level1">
<h1>Question 5 (Page 214 Exercise 6)</h1>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(parallel)
<span class="kw">library</span>(foreach)

<span class="co">#parallel</span>
mcvMap=<span class="cf">function</span>(f, FUN.VALUE , ...) {
    out=<span class="kw">Map</span>(f, ...)
    <span class="kw">vapply</span>(out, FUN, FUN.VALUE)
}


<span class="co">#foreach</span>
y=<span class="kw">foreach</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dt">.combine=</span><span class="st">'rbind'</span>) <span class="op">%do%</span><span class="st"> </span><span class="kw">exp</span>(x)</code></pre></div>
</div>
<div id="homework-10-20181214" class="section level1">
<h1>Homework 10 (2018/12/14)</h1>
</div>
<div id="question-1-17.5.1-exercise-4" class="section level1">
<h1>Question 1 (17.5.1 Exercise 4)</h1>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition ( <a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a> ).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">options</span>(<span class="dt">warn =</span> <span class="op">-</span><span class="dv">1</span>)
chisq_test2=<span class="cf">function</span>(x, y) {
    n=<span class="kw">sum</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y)
    ni._x=<span class="kw">sum</span>(x)
    ni._y=<span class="kw">sum</span>(y)
    chisq.statistic=<span class="dv">0</span>
    <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
      n.j=x[i] <span class="op">+</span><span class="st"> </span>y[i]
      expected_x=(ni._x<span class="op">*</span>n.j)<span class="op">/</span>n
      expected_y=(ni._y<span class="op">*</span>n.j)<span class="op">/</span>n
      chisq.statistic=chisq.statistic<span class="op">+</span>((x[i]<span class="op">-</span>expected_x)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>expected_x
      chisq.statistic=chisq.statistic<span class="op">+</span>((y[i]<span class="op">-</span>expected_y)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>expected_y
    }
    chisq.statistic
  }

x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">9</span>)
y=<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">5</span>)
a=<span class="kw">matrix</span>(<span class="kw">c</span>(x,y),<span class="dv">4</span>,<span class="dv">2</span>)
<span class="kw">print</span>(<span class="kw">chisq_test2</span>(x,y)) </code></pre></div>
<pre><code>## [1] 2.324313</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">chisq.test</span>(a)<span class="op">$</span>statistic) </code></pre></div>
<pre><code>## X-squared 
##  2.324313</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compare the computation time of the two functions</span>

microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">chisq_test2</span>(x,y),<span class="kw">chisq.test</span>(a))</code></pre></div>
<pre><code>## Unit: microseconds
##               expr     min       lq      mean  median       uq     max
##  chisq_test2(x, y)   3.553   4.3430   6.32845   6.711   7.5010  13.027
##      chisq.test(a) 382.900 387.4385 419.23142 411.716 422.9655 654.481
##  neval
##    100
##    100</code></pre>
</div>
<div id="analysis-15" class="section level1">
<h1>Analysis</h1>
<p>From the results,we can see the function chisq_test2 is mucher faster than the function chisq.test.</p>
</div>
<div id="question-2-17.5.1-exercise-5" class="section level1">
<h1>Question 2 (17.5.1 Exercise 5)</h1>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">9</span>)
y=<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">5</span>)
b=<span class="kw">table</span>(x,y)
<span class="kw">summary</span>(b)</code></pre></div>
<pre><code>## Number of cases in table: 4 
## Number of factors: 2 
## Test for independence of all factors:
##  Chisq = 12, df = 9, p-value = 0.2133
##  Chi-squared approximation may be incorrect</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
